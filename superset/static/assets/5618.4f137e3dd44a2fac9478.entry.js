"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5618],{5144:(e,t,r)=>{r.d(t,{Z:()=>H});var a=r(37703),n=r(14890),i=r(22428),o=r(97381),s=r(45697),l=r.n(s),d=r(67294),u=r(29487),c=r(61988),h=r(51995),p=r(68492),m=r(91877),g=r(93185),y=r(9531),b=r(35932),f=r(38703),v=r(57902),Z=r(18446),S=r.n(Z),R=r(11865),C=r.n(R),T=r(88274),w=r(16355),x=r(3741),D=r(11965);const k={annotationData:l().object,actions:l().object,chartId:l().number.isRequired,datasource:l().object,initialValues:l().object,formData:l().object.isRequired,labelColors:l().object,height:l().number,width:l().number,setControlValue:l().func,vizType:l().string.isRequired,triggerRender:l().bool,chartAlert:l().string,chartStatus:l().string,queriesResponse:l().arrayOf(l().object),triggerQuery:l().bool,refreshOverlayVisible:l().bool,addFilter:l().func,setDataMask:l().func,onFilterMenuOpen:l().func,onFilterMenuClose:l().func,ownState:l().object},M={},F={addFilter:()=>M,onFilterMenuOpen:()=>M,onFilterMenuClose:()=>M,initialValues:M,setControlValue(){},triggerRender:!1};class q extends d.Component{constructor(e){super(e),this.hasQueryResponseChange=!1,this.handleAddFilter=this.handleAddFilter.bind(this),this.handleRenderSuccess=this.handleRenderSuccess.bind(this),this.handleRenderFailure=this.handleRenderFailure.bind(this),this.handleSetControlValue=this.handleSetControlValue.bind(this),this.hooks={onAddFilter:this.handleAddFilter,onError:this.handleRenderFailure,setControlValue:this.handleSetControlValue,onFilterMenuOpen:this.props.onFilterMenuOpen,onFilterMenuClose:this.props.onFilterMenuClose,setDataMask:e=>{var t;null==(t=this.props.actions)||t.updateDataMask(this.props.chartId,e)}}}shouldComponentUpdate(e){var t,r;return!(!(e.queriesResponse&&["success","rendered"].indexOf(e.chartStatus)>-1)||null!=(t=e.queriesResponse)&&null!=(r=t[0])&&r.error||e.refreshOverlayVisible)&&(this.hasQueryResponseChange=e.queriesResponse!==this.props.queriesResponse,this.hasQueryResponseChange||!S()(e.datasource,this.props.datasource)||e.annotationData!==this.props.annotationData||e.ownState!==this.props.ownState||e.filterState!==this.props.filterState||e.height!==this.props.height||e.width!==this.props.width||e.triggerRender||e.labelColors!==this.props.labelColors||e.formData.color_scheme!==this.props.formData.color_scheme||e.cacheBusterProp!==this.props.cacheBusterProp)}handleAddFilter(e,t,r=!0,a=!0){this.props.addFilter(e,t,r,a)}handleRenderSuccess(){const{actions:e,chartStatus:t,chartId:r,vizType:a}=this.props;["loading","rendered"].indexOf(t)<0&&e.chartRenderingSucceeded(r),this.hasQueryResponseChange&&e.logEvent(x.aD,{slice_id:r,viz_type:a,start_offset:this.renderStartTime,ts:(new Date).getTime(),duration:x.Yd.getTimestamp()-this.renderStartTime})}handleRenderFailure(e,t){const{actions:r,chartId:a}=this.props;p.Z.warn(e),r.chartRenderingFailed(e.toString(),a,t?t.componentStack:null),this.hasQueryResponseChange&&r.logEvent(x.aD,{slice_id:a,has_err:!0,error_details:e.toString(),start_offset:this.renderStartTime,ts:(new Date).getTime(),duration:x.Yd.getTimestamp()-this.renderStartTime})}handleSetControlValue(...e){const{setControlValue:t}=this.props;t&&t(...e)}render(){const{chartAlert:e,chartStatus:t,vizType:r,chartId:a,refreshOverlayVisible:n}=this.props;if(n||"loading"===t||e||null===t)return null;this.renderStartTime=x.Yd.getTimestamp();const{width:i,height:o,datasource:s,annotationData:l,initialValues:d,ownState:u,filterState:c,formData:h,queriesResponse:p}=this.props,m=C()(r),g="table"===r?`superset-chart-${m}`:m;return(0,D.tZ)(T.Z,{disableErrorBoundary:!0,key:`${a}`,id:`chart-id-${a}`,className:g,chartType:r,width:i,height:o,annotationData:l,datasource:s,initialValues:d,formData:h,ownState:u,filterState:c,hooks:this.hooks,behaviors:[w.cg.INTERACTIVE_CHART],queriesData:p,onRenderSuccess:this.handleRenderSuccess,onRenderFailure:this.handleRenderFailure})}}q.propTypes=k,q.defaultProps=F;const E=q;var O=r(5872),$=r.n(O),_=r(29432),z=r(72875);const I=({chartId:e,error:t,...r})=>{const{result:a}=(0,_.hb)(e),n=t&&{...t,extra:{...t.extra,owners:a}};return(0,D.tZ)(z.Z,$()({},r,{error:n}))},N={annotationData:l().object,actions:l().object,chartId:l().number.isRequired,datasource:l().object,dashboardId:l().number,initialValues:l().object,formData:l().object.isRequired,labelColors:l().object,width:l().number,height:l().number,setControlValue:l().func,timeout:l().number,vizType:l().string.isRequired,triggerRender:l().bool,isFiltersInitialized:l().bool,isDeactivatedViz:l().bool,chartAlert:l().string,chartStatus:l().string,chartStackTrace:l().string,queriesResponse:l().arrayOf(l().object),triggerQuery:l().bool,refreshOverlayVisible:l().bool,errorMessage:l().node,addFilter:l().func,onQuery:l().func,onFilterMenuOpen:l().func,onFilterMenuClose:l().func,ownState:l().object},j={},P=(0,c.t)("The dataset associated with this chart no longer exists"),U={addFilter:()=>j,onFilterMenuOpen:()=>j,onFilterMenuClose:()=>j,initialValues:j,setControlValue(){},triggerRender:!1,dashboardId:null,chartStackTrace:null,isDeactivatedViz:!1},A=h.iK.div`
  min-height: ${e=>e.height}px;
  position: relative;

  .chart-tooltip {
    opacity: 0.75;
    font-size: ${({theme:e})=>e.typography.sizes.s}px;
  }
`,V=h.iK.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
`;class K extends d.PureComponent{constructor(e){super(e),this.handleRenderContainerFailure=this.handleRenderContainerFailure.bind(this)}componentDidMount(){this.props.triggerQuery&&"UNDECIDED"!==this.props.filterboxMigrationState&&this.runQuery()}componentDidUpdate(){if(this.props.triggerQuery&&"UNDECIDED"!==this.props.filterboxMigrationState){if(this.props.isDeactivatedViz&&this.props.queriesResponse)return;this.runQuery()}}runQuery(){this.props.chartId>0&&(0,m.cr)(g.T.CLIENT_CACHE)?this.props.actions.getSavedChart(this.props.formData,!1,this.props.timeout,this.props.chartId,this.props.dashboardId,this.props.ownState):this.props.actions.postChartFormData(this.props.formData,!1,this.props.timeout,this.props.chartId,this.props.dashboardId,this.props.ownState)}handleRenderContainerFailure(e,t){const{actions:r,chartId:a}=this.props;p.Z.warn(e),r.chartRenderingFailed(e.toString(),a,t?t.componentStack:null),r.logEvent(x.aD,{slice_id:a,has_err:!0,error_details:e.toString(),start_offset:this.renderStartTime,ts:(new Date).getTime(),duration:x.Yd.getTimestamp()-this.renderStartTime})}renderErrorMessage(e){var t;const{chartId:r,chartAlert:a,chartStackTrace:n,datasource:i,dashboardId:o,height:s}=this.props,l=null==e||null==(t=e.errors)?void 0:t[0],d=a||(null==e?void 0:e.message);return void 0!==a&&a!==P&&i===y.t?(0,D.tZ)(A,{"data-ui-anchor":"chart",className:"chart-container",height:s},(0,D.tZ)(f.Z,null)):(0,D.tZ)(I,{chartId:r,error:l,subtitle:d,copyText:d,link:e?e.link:null,source:o?"dashboard":"explore",stackTrace:n})}render(){const{height:e,chartAlert:t,chartStatus:r,errorMessage:a,onQuery:n,refreshOverlayVisible:i,queriesResponse:o=[],isDeactivatedViz:s=!1,width:l}=this.props,d="loading"===r,h=i&&!a;return this.renderContainerStartTime=x.Yd.getTimestamp(),"failed"===r?o.map((e=>this.renderErrorMessage(e))):a?(0,D.tZ)(u.Z,{message:a,type:"warning"}):(0,D.tZ)(v.Z,{onError:this.handleRenderContainerFailure,showMessage:!1},(0,D.tZ)(A,{"data-ui-anchor":"chart",className:"chart-container",height:e,width:l},(0,D.tZ)("div",{className:"slice_container "+(h?" faded":"")},(0,D.tZ)(E,this.props)),!d&&!t&&h&&(0,D.tZ)(V,null,(0,D.tZ)(b.Z,{onClick:n,buttonStyle:"primary"},(0,c.t)("Run query"))),d&&!s&&(0,D.tZ)(f.Z,null)))}}K.propTypes=N,K.defaultProps=U;const L=K;var Q=r(74599);const H=(0,a.$j)(null,(function(e){return{actions:(0,n.DE)({...i,updateDataMask:Q.eG,logEvent:o.logEvent},e)}}))(L)},2275:(e,t,r)=>{r.d(t,{cP:()=>l,$6:()=>d,Rw:()=>u,Er:()=>c,DZ:()=>h,$X:()=>p,ck:()=>b});var a=r(45697),n=r.n(a),i=r(81255),o=r(713),s=r(79271);const l=n().shape({id:n().string.isRequired,type:n().oneOf(Object.values(i.ZP)).isRequired,parents:n().arrayOf(n().string),children:n().arrayOf(n().string),meta:n().shape({width:n().number,height:n().number,headerSize:n().oneOf(s.Z.map((e=>e.value))),background:n().oneOf(o.Z.map((e=>e.value))),chartId:n().number})}),d=n().shape({id:n().number.isRequired,chartAlert:n().string,chartStatus:n().string,chartUpdateEndTime:n().number,chartUpdateStartTime:n().number,latestQueryFormData:n().object,queryController:n().shape({abort:n().func}),queriesResponse:n().arrayOf(n().object),triggerQuery:n().bool,lastRendered:n().number}),u=n().shape({slice_id:n().number.isRequired,slice_url:n().string.isRequired,slice_name:n().string.isRequired,datasource:n().string,datasource_name:n().string,datasource_link:n().string,changed_on:n().number.isRequired,modified:n().string.isRequired,viz_type:n().string.isRequired,description:n().string,description_markeddown:n().string,owners:n().arrayOf(n().string)}),c=n().shape({chartId:n().number.isRequired,componentId:n().string.isRequired,filterName:n().string.isRequired,datasourceId:n().string.isRequired,directPathToFilter:n().arrayOf(n().string).isRequired,isDateFilter:n().bool.isRequired,isInstantFilter:n().bool.isRequired,columns:n().object,labels:n().object,scopes:n().object}),h=n().shape({sliceIds:n().arrayOf(n().number).isRequired,expandedSlices:n().object,editMode:n().bool,isPublished:n().bool.isRequired,colorNamespace:n().string,colorScheme:n().string,updatedColorScheme:n().bool,hasUnsavedChanges:n().bool}),p=n().shape({id:n().number.isRequired,metadata:n().object,slug:n().string,dash_edit_perm:n().bool.isRequired,dash_save_perm:n().bool.isRequired,common:n().object,userId:n().string.isRequired}),m=n().shape({value:n().oneOfType([n().number,n().string]).isRequired,label:n().string.isRequired}),g={value:n().oneOfType([n().number,n().string]).isRequired,label:n().string.isRequired,children:n().arrayOf(n().oneOfType([n().shape((y=()=>g,()=>y().apply(void 0,arguments))),m]))};var y;const b=n().oneOfType([n().shape(g),m])},14086:(e,t,r)=>{r.d(t,{Z:()=>h}),r(67294);var a=r(45697),n=r.n(a),i=r(61988),o=r(67190),s=r(37921),l=r(58593),d=r(11965);const u={rowcount:n().number,limit:n().number,rows:n().string,suffix:n().string,loading:n().bool},c={suffix:(0,i.t)("rows")};function h({rowcount:e,limit:t,suffix:r,loading:a}){const n=e===t,u=n||0===e&&!a?"danger":"default",c=(0,o.JB)()(e),h=(0,d.tZ)("span",null,n&&(0,d.tZ)("div",null,(0,i.t)("Limit reached")),a?"Loading":e);return(0,d.tZ)(l.u,{id:"tt-rowcount-tooltip",title:h},(0,d.tZ)(s.Z,{type:u},a?"Loading...":`${c} ${r}`))}h.propTypes=u,h.defaultProps=c},87189:(e,t,r)=>{r.d(t,{n:()=>i});var a=r(67294),n=r(23525);function i(e){const[t,r]=(0,a.useState)(!1),[i,o]=(0,a.useState)("");return(0,a.useEffect)((()=>r(!0)),[e]),async function(){if(t){const t=await(0,n.O)(e);return o(t),r(!1),t}return i}}},37488:(e,t,r)=>{r.d(t,{Z:()=>i}),r(67294);var a=r(11965),n={name:"1qbe4ct",styles:"& :nth-child(1):not(:nth-last-child(1)){border-top-right-radius:0;border-bottom-right-radius:0;border-right:0;margin-left:0;}& :not(:nth-child(1)):not(:nth-last-child(1)){border-radius:0;border-right:0;margin-left:0;}& :nth-last-child(1):not(:nth-child(1)){border-top-left-radius:0;border-bottom-left-radius:0;margin-left:0;}"};function i(e){const{className:t,children:r}=e;return(0,a.tZ)("div",{role:"group",className:t,css:n},r)}},9433:(e,t,r)=>{r.d(t,{CronPicker:()=>c});var a=r(5872),n=r.n(a),i=(r(67294),r(79409)),o=r(61988),s=r(51995),l=r(61247),d=r(11965);const u={everyText:(0,o.t)("every"),emptyMonths:(0,o.t)("every month"),emptyMonthDays:(0,o.t)("every day of the month"),emptyMonthDaysShort:(0,o.t)("day of the month"),emptyWeekDays:(0,o.t)("every day of the week"),emptyWeekDaysShort:(0,o.t)("day of the week"),emptyHours:(0,o.t)("every hour"),emptyMinutes:(0,o.t)("every minute"),emptyMinutesForHourPeriod:(0,o.t)("every"),yearOption:(0,o.t)("year"),monthOption:(0,o.t)("month"),weekOption:(0,o.t)("week"),dayOption:(0,o.t)("day"),hourOption:(0,o.t)("hour"),minuteOption:(0,o.t)("minute"),rebootOption:(0,o.t)("reboot"),prefixPeriod:(0,o.t)("Every"),prefixMonths:(0,o.t)("in"),prefixMonthDays:(0,o.t)("on"),prefixWeekDays:(0,o.t)("on"),prefixWeekDaysForMonthAndYearPeriod:(0,o.t)("and"),prefixHours:(0,o.t)("at"),prefixMinutes:(0,o.t)(":"),prefixMinutesForHourPeriod:(0,o.t)("at"),suffixMinutesForHourPeriod:(0,o.t)("minute(s)"),errorInvalidCron:(0,o.t)("Invalid cron expression"),clearButtonText:(0,o.t)("Clear"),weekDays:[(0,o.t)("Sunday"),(0,o.t)("Monday"),(0,o.t)("Tuesday"),(0,o.t)("Wednesday"),(0,o.t)("Thursday"),(0,o.t)("Friday"),(0,o.t)("Saturday")],months:[(0,o.t)("January"),(0,o.t)("February"),(0,o.t)("March"),(0,o.t)("April"),(0,o.t)("May"),(0,o.t)("June"),(0,o.t)("July"),(0,o.t)("August"),(0,o.t)("September"),(0,o.t)("October"),(0,o.t)("November"),(0,o.t)("December")],altWeekDays:[(0,o.t)("SUN"),(0,o.t)("MON"),(0,o.t)("TUE"),(0,o.t)("WED"),(0,o.t)("THU"),(0,o.t)("FRI"),(0,o.t)("SAT")],altMonths:[(0,o.t)("JAN"),(0,o.t)("FEB"),(0,o.t)("MAR"),(0,o.t)("APR"),(0,o.t)("MAY"),(0,o.t)("JUN"),(0,o.t)("JUL"),(0,o.t)("AUG"),(0,o.t)("SEP"),(0,o.t)("OCT"),(0,o.t)("NOV"),(0,o.t)("DEC")]},c=(0,s.iK)((e=>(0,d.tZ)(i.ZP,{getPopupContainer:e=>e.parentElement},(0,d.tZ)(l.Z,n()({locale:u},e)))))`
  .react-js-cron-select:not(.react-js-cron-custom-select) > div:first-of-type,
  .react-js-cron-custom-select {
    border-radius: ${({theme:e})=>e.gridUnit}px;
    background-color: ${({theme:e})=>e.colors.grayscale.light4} !important;
  }
  .react-js-cron-custom-select > div:first-of-type {
    border-radius: ${({theme:e})=>e.gridUnit}px;
  }
`},38270:(e,t,r)=>{r.d(t,{Z:()=>h});var a=r(67294),n=r(94184),i=r.n(n),o=r(51995),s=r(61988),l=r(58593),d=r(79789),u=r(11965);const c=(0,o.iK)(d.Z)`
  vertical-align: middle;
`;function h({canEdit:e=!1,editing:t=!1,extraClasses:r,multiLine:n=!1,noPermitTooltip:o,onSaveTitle:d,showTooltip:h=!0,style:p,title:m="",defaultTitle:g="",placeholder:y="",certifiedBy:b,certificationDetails:f}){const[v,Z]=(0,a.useState)(t),[S,R]=(0,a.useState)(m),[C,T]=(0,a.useState)(m),[w,x]=(0,a.useState)(null),D=(0,a.useRef)();function k(){if(!e||v)return;const t=D.current?D.current.getBoundingClientRect():null;Z(!0),x(t)}function M(){const t=S.trim();e&&(Z(!1),t.length?(C!==t&&T(t),m!==t&&d(t)):R(C))}function F(e){" "===e.key&&e.stopPropagation(),"Enter"===e.key&&(e.preventDefault(),M())}function q(t){e&&R(t.target.value)}function E(e){"Enter"===e.key&&(e.preventDefault(),M())}let O;(0,a.useEffect)((()=>{m!==S&&(T(S),R(m))}),[m]),(0,a.useEffect)((()=>{if(v&&(D.current.focus(),D.current.setSelectionRange)){const{length:e}=D.current.value;D.current.setSelectionRange(e,e),D.current.scrollLeft=D.current.scrollWidth,D.current.scrollTop=D.current.scrollHeight}}),[v]),O=S,v||S||(O=g||m);const $=v&&w?{height:`${w.height}px`}:void 0;let _=n&&v?(0,u.tZ)("textarea",{ref:D,value:O,className:m?void 0:"text-muted",onKeyDown:F,onChange:q,onBlur:M,onClick:k,onKeyPress:E,placeholder:y,style:$}):(0,u.tZ)("input",{ref:D,type:v?"text":"button",value:O,className:m?void 0:"text-muted",onKeyDown:F,onChange:q,onBlur:M,onClick:k,onKeyPress:E,placeholder:y});return h&&!v&&(_=(0,u.tZ)(l.u,{id:"title-tooltip",title:e?(0,s.t)("Click to edit"):o||(0,s.t)("You don't have the rights to alter this title.")},_)),e||(_=(0,u.tZ)("span",{title:O},O)),(0,u.tZ)("span",{className:i()("editable-title",r,e&&"editable-title--editable",v&&"editable-title--editing"),style:p},b&&(0,u.tZ)(a.Fragment,null,(0,u.tZ)(c,{certifiedBy:b,details:f})," "),_)}},48600:(e,t,r)=>{r.d(t,{Z:()=>y});var a=r(11965),n=r(67294),i=r(37703),o=r(51995),s=r(61988),l=r(38097),d=r(12441),u=r(82191),c=r(91877),h=r(93185),p=r(17198);const m=e=>a.iv`
  color: ${e.colors.error.base};
`;var g={name:"833hqy",styles:"width:200px"};function y({showReportModal:e,toggleActive:t,deleteActiveReport:r}){const y=(0,i.v9)((e=>e.reports)),b=y[Object.keys(y)[0]],[f,v]=(0,n.useState)(null),Z=(0,o.Fg)();return(0,c.cr)(h.T.ALERT_REPORTS)?(0,a.tZ)(n.Fragment,null,(0,a.tZ)(u.$i,{overlay:(0,a.tZ)(u.v2,{selectable:!1,css:g},(0,a.tZ)(u.v2.Item,null,(0,s.t)("Email reports active"),(0,a.tZ)(d.r,{checked:null==b?void 0:b.active,onClick:e=>(async(e,r)=>{null!=e&&e.id&&t(e,r)})(b,e),size:"small",css:(0,a.iv)({marginLeft:2*Z.gridUnit},"","")})),(0,a.tZ)(u.v2.Item,{onClick:e},(0,s.t)("Edit email report")),(0,a.tZ)(u.v2.Item,{onClick:()=>v(b),css:m},(0,s.t)("Delete email report"))),trigger:["click"],getPopupContainer:e=>e.closest(".action-button")},(0,a.tZ)("span",{role:"button",className:"action-button",tabIndex:0},(0,a.tZ)(l.Z.Calendar,null))),f&&(0,a.tZ)(p.Z,{description:(0,s.t)("This action will permanently delete %s.",f.name),onConfirm:()=>{f&&(e=>{r(e),v(null)})(f)},onHide:()=>v(null),open:!0,title:(0,s.t)("Delete Report?")})):null}},97860:(e,t,r)=>{r.d(t,{Z:()=>$});var a=r(67294),n=r(61988),i=r(14890),o=r(37703),s=r(61358),l=r(98978),d=r(70917),u=r(38097),c=r(14114),h=r(51995),p=r(11965),m=r(74069),g=r(35932),y=r(87183),b=r(9433);const f=(0,h.iK)(m.Z)`
  .ant-modal-body {
    padding: 0;
  }

  h4 {
    font-weight: 600;
  }
`,v=h.iK.div`
  padding: ${({theme:e})=>`${3*e.gridUnit}px ${4*e.gridUnit}px ${2*e.gridUnit}px`};
  label {
    font-size: ${({theme:e})=>e.typography.sizes.s-1}px;
    color: ${({theme:e})=>e.colors.grayscale.light1};
  }
`,Z=h.iK.div`
  border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  padding: ${({theme:e})=>`${4*e.gridUnit}px ${4*e.gridUnit}px ${6*e.gridUnit}px`};
  .ant-select {
    width: 100%;
  }
  .control-label {
    font-size: ${({theme:e})=>e.typography.sizes.s-1}px;
    color: ${({theme:e})=>e.colors.grayscale.light1};
  }
`,S=h.iK.span`
  span {
    margin-right: ${({theme:e})=>2*e.gridUnit}px;
    vertical-align: middle;
  }
  .text {
    vertical-align: middle;
  }
`,R=h.iK.div`
  margin-bottom: ${({theme:e})=>7*e.gridUnit}px;

  h4 {
    margin-bottom: ${({theme:e})=>3*e.gridUnit}px;
  }
`,C=(0,h.iK)(b.CronPicker)`
  margin-bottom: ${({theme:e})=>3*e.gridUnit}px;
`,T=h.iK.p`
  color: ${({theme:e})=>e.colors.error.base};
`,w=p.iv`
  margin-bottom: 0;
`,x=(0,h.iK)(g.Z)`
  width: ${({theme:e})=>40*e.gridUnit}px;
`,D=h.iK.div`
  margin: ${({theme:e})=>8*e.gridUnit}px 0
    ${({theme:e})=>4*e.gridUnit}px;
`,k=(0,h.iK)(y.Y)`
  display: block;
  line-height: ${({theme:e})=>8*e.gridUnit}px;
`,M=(0,h.iK)(y.Y.Group)`
  margin-left: ${({theme:e})=>.5*e.gridUnit}px;
`;var F;!function(e){e[e.inputChange=0]="inputChange",e[e.fetched=1]="fetched",e[e.reset=2]="reset"}(F||(F={}));const q=["pivot_table","pivot_table_v2","table","paired_ttest"],E="TEXT",O=(e,t)=>{const r={name:"Weekly Report"};switch(t.type){case F.inputChange:return{...r,...e,[t.payload.name]:t.payload.value};case F.fetched:return{...r,...t.payload};case F.reset:return{...r};default:return e}},$=(0,o.$j)(null,(e=>(0,i.DE)({addReport:s.cq,editReport:s.Me},e)))((0,c.Z)((({onReportAdd:e,onHide:t,show:r=!1,...i})=>{var c,h;const m=null==(c=i.props.chart)||null==(h=c.sliceFormData)?void 0:h.viz_type,g=!!i.props.chart,y=g&&q.includes(m)?E:"PNG",[b,$]=(0,a.useReducer)(O,null),_=(0,a.useCallback)(((e,t)=>{$({type:e,payload:t})}),[]),[z,I]=(0,a.useState)(),N=(0,o.I0)(),j=(0,o.v9)((e=>e.reports)),P=j&&Object.keys(j).length;(0,a.useEffect)((()=>{if(P){const e=Object.keys(j),t=j[e[0]];$({type:F.fetched,payload:t})}else $({type:F.reset})}),[j]);const U=()=>{t()},A=(0,p.tZ)(S,null,(0,p.tZ)(u.Z.Calendar,null),(0,p.tZ)("span",{className:"text"},P?(0,n.t)("Edit Email Report"):(0,n.t)("New Email Report"))),V=(0,p.tZ)(a.Fragment,null,(0,p.tZ)(x,{key:"back",onClick:U},(0,n.t)("Cancel")),(0,p.tZ)(x,{key:"submit",buttonStyle:"primary",onClick:async()=>{var t;const r={crontab:null==b?void 0:b.crontab,dashboard:i.props.dashboardId,chart:null==(t=i.props.chart)?void 0:t.id,description:null==b?void 0:b.description,name:null==b?void 0:b.name,owners:[i.props.userId],recipients:[{recipient_config_json:{target:i.props.userEmail},type:"Email"}],type:"Report",creation_method:i.props.creationMethod,active:!0,report_format:(null==b?void 0:b.report_format)||y,timezone:null==b?void 0:b.timezone};P?await N((0,s.Me)(null==b?void 0:b.id,r)):await N((0,s.cq)(r)),e&&e(),U()},disabled:!(null!=b&&b.name)},P?(0,n.t)("Save"):(0,n.t)("Add"))),K=(0,p.tZ)(a.Fragment,null,(0,p.tZ)(D,null,(0,p.tZ)("h4",null,(0,n.t)("Message Content"))),(0,p.tZ)("div",{className:"inline-container"},(0,p.tZ)(M,{onChange:e=>{_(F.inputChange,{name:"report_format",value:e.target.value})},value:(null==b?void 0:b.report_format)||y},q.includes(m)&&(0,p.tZ)(k,{value:E},(0,n.t)("Text embedded in email")),(0,p.tZ)(k,{value:"PNG"},(0,n.t)("Image (PNG) embedded in email")),(0,p.tZ)(k,{value:"CSV"},(0,n.t)("Formatted CSV attached in email")))));return(0,p.tZ)(f,{show:r,onHide:U,title:A,footer:V,width:"432",centered:!0},(0,p.tZ)(v,null,(0,p.tZ)(d.Z,{id:"name",name:"name",value:(null==b?void 0:b.name)||"",placeholder:"Weekly Report",required:!0,validationMethods:{onChange:({target:e})=>_(F.inputChange,{name:e.name,value:e.value})},errorMessage:"error"===(null==b?void 0:b.name)?(0,n.t)("REPORT NAME ERROR"):"",label:"Report Name"}),(0,p.tZ)(d.Z,{id:"description",name:"description",value:(null==b?void 0:b.description)||"",validationMethods:{onChange:({target:e})=>_(F.inputChange,{name:e.name,value:e.value})},errorMessage:"error"===(null==b?void 0:b.description)?(0,n.t)("DESCRIPTION ERROR"):"",label:"Description",placeholder:"Include a description that will be sent with your report",css:w})),(0,p.tZ)(Z,null,(0,p.tZ)(R,null,(0,p.tZ)("h4",{css:e=>(e=>p.iv`
  margin: ${3*e.gridUnit}px 0;
  font-weight: ${e.typography.weights.bold};
`)(e)},(0,n.t)("Schedule")),(0,p.tZ)("p",null,(0,n.t)("Scheduled reports will be sent to your email as a PNG"))),(0,p.tZ)(C,{clearButton:!1,value:(null==b?void 0:b.crontab)||"0 12 * * 1",setValue:e=>{_(F.inputChange,{name:"crontab",value:e})},onError:I}),(0,p.tZ)(T,null,z),(0,p.tZ)("div",{className:"control-label",css:e=>(e=>p.iv`
  margin: ${3*e.gridUnit}px 0 ${2*e.gridUnit}px;
`)(e)},(0,n.t)("Timezone")),(0,p.tZ)(l.Z,{onTimezoneChange:e=>{$({type:F.inputChange,payload:{name:"timezone",value:e}})},timezone:null==b?void 0:b.timezone}),g&&K))})))},12441:(e,t,r)=>{r.d(t,{r:()=>s}),r(67294);var a=r(51995),n=r(40987),i=r(11965);const o=(0,a.iK)(n.Z)`
  .ant-switch-checked {
    background-color: ${({theme:e})=>e.colors.primary.base};
  }
`,s=e=>(0,i.tZ)(o,e)},98978:(e,t,r)=>{r.d(t,{Z:()=>Z});var a=r(11965),n=r(67294),i=r(80008),o=r.n(i),s=r(61988),l=r(4715);const d="GMT Standard Time",u="Africa/Abidjan",c={"-300-240":["Eastern Standard Time","Eastern Daylight Time"],"-360-300":["Central Standard Time","Central Daylight Time"],"-420-360":["Mountain Standard Time","Mountain Daylight Time"],"-420-420":["Mountain Standard Time - Phoenix","Mountain Standard Time - Phoenix"],"-480-420":["Pacific Standard Time","Pacific Daylight Time"],"-540-480":["Alaska Standard Time","Alaska Daylight Time"],"-600-600":["Hawaii Standard Time","Hawaii Daylight Time"],60120:["Central European Time","Central European Daylight Time"],"00":[d,d],"060":["GMT Standard Time - London","British Summer Time"]},h=o()(),p=o()([2021,1]),m=o()([2021,7]),g=e=>p.tz(e).utcOffset().toString()+m.tz(e).utcOffset().toString(),y=e=>{var t,r;const a=g(e);return(h.tz(e).isDST()?null==(t=c[a])?void 0:t[1]:null==(r=c[a])?void 0:r[0])||e},b=o().tz.countries().map((e=>o().tz.zonesForCountry(e,!0))).flat(),f=[];b.forEach((e=>{f.find((t=>g(t.name)===g(e.name)))||f.push(e)}));const v=f.map((e=>({label:`GMT ${o().tz(h,e.name).format("Z")} (${y(e.name)})`,value:e.name,offsets:g(e.name),timezoneName:e.name}))),Z=({onTimezoneChange:e,timezone:t})=>{const r=(0,n.useRef)(t),i=(0,n.useCallback)((t=>{r.current=t,e(t)}),[e]);return(0,n.useEffect)((()=>{const e=(e=>{var t;return(null==(t=v.find((t=>t.offsets===g(e))))?void 0:t.value)||u})(t||o().tz.guess());r.current!==e&&i(e)}),[t,i]),(0,a.tZ)(l.P,{ariaLabel:(0,s.t)("Timezone selector"),css:(0,a.iv)({minWidth:"400px"},"",""),onChange:e,value:t||u,options:v,sortComparator:(e,t)=>o().tz(h,e.timezoneName).utcOffset()-o().tz(h,t.timezoneName).utcOffset()})}},9531:(e,t,r)=>{r.d(t,{t:()=>a});const a={id:0,type:r(46078).i.Table,uid:"_placeholder_",datasource_name:"",table_name:"",columns:[],column_types:[],metrics:[],column_format:{},verbose_map:{},main_dttm_col:"",description:""}},713:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(61988),n=r(80621);const i=[{value:n.HE,label:(0,a.t)("Transparent"),className:"background--transparent"},{value:n.b5,label:(0,a.t)("White"),className:"background--white"}]},79271:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(61988),n=r(80621);const i=[{value:n.u_,label:(0,a.t)("Small"),className:"header-style-option header-small"},{value:n.OE,label:(0,a.t)("Medium"),className:"header-style-option header-medium"},{value:n.pQ,label:(0,a.t)("Large"),className:"header-style-option header-large"}]},50909:(e,t,r)=>{r.d(t,{qi:()=>g,m:()=>b,HS:()=>f,uy:()=>v,C4:()=>Z,_q:()=>S});var a=r(67294),n=r(51995),i=r(61988),o=r(23279),s=r.n(o),l=r(82191),d=r(27600),u=r(35932),c=r(54076),h=r(13433),p=r(14086),m=r(11965);const g=(0,n.iK)(u.Z)`
  font-size: ${({theme:e})=>e.typography.sizes.s}px;

  // needed to override button's first-of-type margin: 0
  && {
    margin: 0 ${({theme:e})=>2*e.gridUnit}px;
  }

  i {
    padding: 0 ${({theme:e})=>e.gridUnit}px;
  }
`,y=(0,m.tZ)(g,{buttonSize:"xsmall","aria-label":(0,i.t)("Copy")},(0,m.tZ)("i",{className:"fa fa-clipboard"})),b=({data:e,columns:t})=>(0,m.tZ)(h.Z,{text:e&&t?(0,c.Mv)(e,t):"",wrapped:!1,copyNode:y}),f=({onChangeHandler:e})=>{const t=s()(e,d.M$);return(0,m.tZ)(l.II,{placeholder:(0,i.t)("Search"),onChange:e=>{const r=e.target.value;t(r)}})},v=({data:e,loading:t})=>{var r;return(0,m.tZ)(p.Z,{rowcount:null!=(r=null==e?void 0:e.length)?r:0,loading:t,suffix:(0,i.t)("rows retrieved")})},Z=(e,t)=>{const r=(0,a.useMemo)((()=>{var e;return null!=(e=null==t?void 0:t.map((e=>Object.values(e).map((e=>null==e?void 0:e.toString().toLowerCase())))))?e:[]}),[t]);return(0,a.useMemo)((()=>null!=t&&t.length?t.filter(((t,a)=>r[a].some((t=>null==t?void 0:t.includes(e.toLowerCase()))))):[]),[t,e,r])},S=(e,t,r)=>(0,a.useMemo)((()=>e&&null!=t&&t.length?e.filter((e=>Object.keys(t[0]).includes(e))).map((e=>({accessor:t=>t[e],Header:e||" ",Cell:({value:e})=>!0===e?d.Ly:!1===e?d.gz:String(e),...null==r?void 0:r[e]}))):[]),[t,e,r])},15423:(e,t,r)=>{r.d(t,{Z:()=>R});var a=r(67294),n=r(51995),i=r(55786),o=r(61988),s=r(42110),l=r(120),d=r(13433),u=r(38703),c=r(50909),h=r(98286),p=r(22428),m=r(53459),g=r(49889),y=r(33743),b=r(22489),f=r(11965);const v=(0,n.iK)(c.qi)`
  && {
    margin: 0 0 ${({theme:e})=>e.gridUnit}px;
  }
`;s.Z.registerLanguage("markdown",m.Z),s.Z.registerLanguage("html",g.Z),s.Z.registerLanguage("sql",y.Z),s.Z.registerLanguage("json",b.Z);const Z=n.iK.div`
  height: 100%;
`,S=(0,n.iK)(s.Z)`
  height: calc(100% - 26px); // 100% - clipboard height
`,R=e=>{const[t,r]=(0,a.useState)([]),[n,s]=(0,a.useState)(!1),[c,m]=(0,a.useState)(null);return(0,a.useEffect)((()=>{s(!0),(0,p.getChartDataRequest)({formData:e.latestQueryFormData,resultFormat:"json",resultType:"query"}).then((({json:e})=>{r((0,i.Z)(e.result)),s(!1),m(null)})).catch((e=>{(0,h.O)(e).then((({error:t,message:r})=>{m(t||r||e.statusText||(0,o.t)("Sorry, An error occurred")),s(!1)}))}))}),[JSON.stringify(e.latestQueryFormData)]),n?(0,f.tZ)(u.Z,null):c?(0,f.tZ)("pre",null,c):(0,f.tZ)(a.Fragment,null,t.map((e=>e.query?(0,f.tZ)(Z,{key:e.query},(0,f.tZ)(d.Z,{text:e.query,shouldShowText:!1,copyNode:(0,f.tZ)(v,{buttonSize:"xsmall"},(0,f.tZ)("i",{className:"fa fa-clipboard"}))}),(0,f.tZ)(S,{language:e.language||void 0,style:l.Z},e.query)):null)))}},56727:(e,t,r)=>{r.d(t,{Z:()=>d}),r(15306);var a=r(29306),n=r.n(a),i=r(21804),o=r.n(i),s=r(61988),l=r(72570);function d(e,t,r={},a=!1){return r=>{const i=a?document.querySelector(e):r.currentTarget.closest(e);return i?n().toJpeg(i,{quality:.95,bgcolor:"#F5F5F5",filter:e=>"string"!=typeof e.className||"mapboxgl-control-container"!==e.className&&!e.className.includes("ant-dropdown")}).then((e=>{const r=document.createElement("a");r.download=`${((e,t=new Date)=>`${o()(e)}-${t.toISOString().replace(/[: ]/g,"-")}`)(t)}.jpg`,r.href=e,r.click()})).catch((e=>{console.error("Creating image failed",e)})):(0,l.Dz)((0,s.t)("Image download failed, please refresh and try again."))}}}}]);