(()=>{var e,t,a,r,o,n,s,i={90001:(e,t,a)=>{"use strict";var r={};a.r(r),a.d(r,{FETCH_DASHBOARDS_FAILED:()=>D,FETCH_DASHBOARDS_SUCCEEDED:()=>N,REMOVE_SAVE_MODAL_ALERT:()=>P,SAVE_SLICE_FAILED:()=>M,SAVE_SLICE_SUCCESS:()=>U,fetchDashboards:()=>k,fetchDashboardsFailed:()=>I,fetchDashboardsSucceeded:()=>A,removeSaveModalAlert:()=>F,saveSlice:()=>L,saveSliceFailed:()=>j,saveSliceSuccess:()=>$});var o={};a.r(o),a.d(o,{CREATE_NEW_SLICE:()=>ge,FETCH_DATASOURCES_STARTED:()=>te,FETCH_DATASOURCES_SUCCEEDED:()=>re,FETCH_DATASOURCE_SUCCEEDED:()=>X,FETCH_FAVE_STAR:()=>ie,POST_DATASOURCE_STARTED:()=>Y,SAVE_FAVE_STAR:()=>le,SET_DATASOURCE:()=>W,SET_DATASOURCES:()=>G,SET_DATASOURCE_TYPE:()=>Q,SET_EXPLORE_CONTROLS:()=>fe,SET_FIELD_VALUE:()=>ue,SLICE_UPDATED:()=>ye,TOGGLE_FAVE_STAR:()=>ne,UPDATE_CHART_TITLE:()=>me,createNewSlice:()=>ve,exploreActions:()=>Se,fetchDatasourceSucceeded:()=>ee,fetchDatasourcesStarted:()=>ae,fetchDatasourcesSucceeded:()=>oe,fetchFaveStar:()=>ce,saveFaveStar:()=>de,setControlValue:()=>he,setDatasource:()=>K,setDatasourceType:()=>B,setDatasources:()=>J,setExploreControls:()=>pe,sliceUpdated:()=>_e,toggleFaveStar:()=>se,updateChartTitle:()=>be});var n=a(67294),s=a(73935),i=a(14890),c=a(53894),l=a(14670),d=a.n(l),u=a(31069),h=a(9679),f=a(97381),p=a(3741),m=a(23279),b=a.n(m);const g=new class{constructor({callback:e=(()=>{}),sizeThreshold:t=1e3,delayThreshold:a=1e3}){this.queue=[],this.sizeThreshold=t,this.delayThrehold=a,this.trigger=b()(this.trigger.bind(this),this.delayThrehold),this.callback=e}append(e){this.queue.push(e),this.trigger()}trigger(){if(this.queue.length>0){const e=this.queue.splice(0,this.sizeThreshold);this.callback.call(null,e),this.queue.length>0&&this.trigger()}}}({callback:e=>{if(e.length<=0)return;let t="/superset/log/?explode=events";const{source:a,source_id:r}=e[0];if("dashboard"===a?t+=`&dashboard_id=${r}`:"slice"===a&&(t+=`&slice_id=${r}`),navigator.sendBeacon){const a=new FormData;a.append("events",(0,h.o)(e)),navigator.sendBeacon(t,a)}else u.Z.post({endpoint:t,postPayload:{events:e},parseMethod:null})},sizeThreshold:1024,delayThreshold:1e3});let v=0;var y=a(91877),_=a(99543),S=a(72570),E=a(8818);function Z(e=[]){const t=[];return e.forEach((([e,a])=>{const r="danger"===e?E.p.DANGER:"success"===e&&E.p.SUCCESS||E.p.INFO,o=(0,S.fz)({text:a,toastType:r}).payload;t.push(o)})),t}var w=a(12515),C=a(35854),T=a(97488),R=a(61358),O=a(64714),x=a(8868);const N="FETCH_DASHBOARDS_SUCCEEDED";function A(e){return{type:N,choices:e}}const D="FETCH_DASHBOARDS_FAILED";function I(e){return{type:D,userId:e}}function k(e){return function(t){return u.Z.get({endpoint:`/dashboardasync/api/read?_flt_0_owners=${e}`}).then((({json:e})=>{const a=e.pks.map(((t,a)=>({value:t,label:(e.result[a]||{}).dashboard_title})));return t(A(a))})).catch((()=>t(I(e))))}}const M="SAVE_SLICE_FAILED";function j(){return{type:M}}const U="SAVE_SLICE_SUCCESS";function $(e){return{type:U,data:e}}const P="REMOVE_SAVE_MODAL_ALERT";function F(){return{type:P}}function L(e,t){return a=>{const r=(0,w.H6)({formData:e,endpointType:"base",force:!1,curUrl:null,requestParams:t}),o=(0,w.u)({formData:e,force:!1,resultFormat:"json",resultType:"full"});return u.Z.post({url:r,postPayload:{form_data:e,query_context:o}}).then((e=>(a($(e.json)),e.json))).catch((()=>a(j())))}}var z=a(22428),V=a(69856),H=a(61988);const q="/superset/favstar/slice",Q="SET_DATASOURCE_TYPE";function B(e){return{type:Q,datasourceType:e}}const W="SET_DATASOURCE";function K(e){return{type:W,datasource:e}}const G="SET_DATASOURCES";function J(e){return{type:G,datasources:e}}const Y="POST_DATASOURCE_STARTED",X="FETCH_DATASOURCE_SUCCEEDED";function ee(){return{type:X}}const te="FETCH_DATASOURCES_STARTED";function ae(){return{type:te}}const re="FETCH_DATASOURCES_SUCCEEDED";function oe(){return{type:re}}const ne="TOGGLE_FAVE_STAR";function se(e){return{type:ne,isStarred:e}}const ie="FETCH_FAVE_STAR";function ce(e){return function(t){u.Z.get({endpoint:`${q}/${e}/count/`}).then((({json:e})=>{e.count>0&&t(se(!0))}))}}const le="SAVE_FAVE_STAR";function de(e,t){return function(a){const r=t?"unselect":"select";u.Z.get({endpoint:`${q}/${e}/${r}/`}).then((()=>a(se(!t)))).catch((()=>{a((0,S.Gb)((0,H.t)("An error occurred while starring this chart")))}))}}const ue="SET_FIELD_VALUE";function he(e,t,a){return{type:ue,controlName:e,value:t,validationErrors:a}}const fe="UPDATE_EXPLORE_CONTROLS";function pe(e){return{type:fe,formData:e}}const me="UPDATE_CHART_TITLE";function be(e){return{type:me,sliceName:e}}const ge="CREATE_NEW_SLICE";function ve(e,t,a,r,o){return{type:ge,can_add:e,can_download:t,can_overwrite:a,slice:r,form_data:o}}const ye="SLICE_UPDATED";function _e(e){return{type:ye,slice:e}}const Se={...S.s2,setDatasourceType:B,setDatasource:K,setDatasources:J,fetchDatasourcesStarted:ae,fetchDatasourcesSucceeded:oe,toggleFaveStar:se,fetchFaveStar:ce,saveFaveStar:de,setControlValue:he,setExploreControls:pe,updateChartTitle:be,createNewSlice:ve,sliceUpdated:_e},Ee=(0,i.UY)({charts:O.Z,saveModal:function(e={},t){const a={[N]:()=>({...e,dashboards:t.choices}),[D]:()=>({...e,saveModalAlert:`fetching dashboards failed for ${t.userId}`}),[M]:()=>({...e,saveModalAlert:"Failed to save slice"}),[U]:t=>({...e,data:t}),[P]:()=>({...e,saveModalAlert:null})};return t.type in a?a[t.type]():e},dataMask:x.Z,explore:function(e={},t){const a={[z.DYNAMIC_PLUGIN_CONTROLS_READY]:()=>({...e,controls:t.controlsState}),[ne]:()=>({...e,isStarred:t.isStarred}),[Y]:()=>({...e,isDatasourceMetaLoading:!0}),[W](){const a={...e.form_data};t.datasource.type!==e.datasource.type&&("table"===t.datasource.type?(a.granularity_sqla=t.datasource.granularity_sqla,a.time_grain_sqla=t.datasource.time_grain_sqla,delete a.druid_time_origin,delete a.granularity):(a.druid_time_origin=t.datasource.druid_time_origin,a.granularity=t.datasource.granularity,delete a.granularity_sqla,delete a.time_grain_sqla));const r={...e.controls};t.datasource.id===e.datasource.id&&t.datasource.type===e.datasource.type||(a.time_range=V.X5,Object.entries(r).forEach((([e,t])=>{("column_name"===t.valueKey||"columns"in t)&&(r[e]={...t,value:void 0},a[e]=void 0)})));const o={...e,controls:r,datasource:t.datasource,datasource_id:t.datasource.id,datasource_type:t.datasource.type};return{...o,form_data:a,controls:(0,C.R3)(o,a)}},[te]:()=>({...e,isDatasourcesLoading:!0}),[G]:()=>({...e,datasources:t.datasources}),[ue](){const a=e.form_data,{controlName:r,value:o,validationErrors:n}=t;a[r]=o;const s=a.viz_type,i=e.controls[t.controlName]||(0,T.Bx)(t.controlName,s)||{},c={...(0,T.vP)(i,e,t.value)},l={...e,controls:{...e.controls,[t.controlName]:c}},d={};Array.isArray(c.rerender)&&c.rerender.forEach((e=>{d[e]={...(0,T.vP)(l.controls[e],l,l.controls[e].value)}}));const u=c.validationErrors||[];(n||[]).forEach((e=>{u.includes(e)||u.push(e)}));const h=u&&u.length>0,f="viz_type"===t.controlName&&t.value!==e.controls.viz_type.value?(0,C.R3)(e,(0,T.Hu)({...e.controls,viz_type:c})):e.controls;return{...e,form_data:a,triggerRender:c.renderTrigger&&!h,controls:{...f,[t.controlName]:{...c,validationErrors:u},...d}}},[fe]:()=>({...e,controls:(0,C.R3)(e,t.formData)}),[me]:()=>({...e,sliceName:t.sliceName}),[ge]:()=>({...e,slice:t.slice,controls:(0,C.R3)(e,t.form_data),can_add:t.can_add,can_download:t.can_download,can_overwrite:t.can_overwrite}),[ye](){var a,r;return{...e,slice:{...e.slice,...t.slice,owners:null!=(a=t.slice.owners)?a:null},sliceName:null!=(r=t.slice.slice_name)?r:e.sliceName}}};return t.type in a?a[t.type]():e},impressionId:(e="")=>e,messageToasts:function(e=[],t){switch(t.type){case S.h:{const{payload:a}=t,r=e.slice();return a.noDuplicate&&r.find((e=>e.text===a.text))?e:[a,...e]}case S.K7:{const{payload:{id:a}}=t;return[...e].filter((e=>e.id!==a))}default:return e}},reports:function(e={},t){const a={[R.jt]:()=>({...t.report.result.reduce(((e,t)=>({...e,[t.id]:t})),{})}),[R.J8](){const a=t.json.result;return a.id=t.json.id,{...e,[t.json.id]:a}},[R.Dr](){const a=t.json.result;return a.id=t.json.id,{...e,[t.json.id]:a}}};return t.type in a?a[t.type]():e}});var Ze=a(37703),we=a(38626),Ce=a(57865),Te=a(68135),Re=a(14278),Oe=a(51995),xe=a(11965),Ne=a(94184),Ae=a.n(Ne),De=a(13423),Ie=a(38097);const ke=Oe.iK.div`
  display: flex;
  justify-content: center;
  align-items: center;

  span {
    padding: 0 11px;
  }
`,Me=e=>xe.iv`
  min-width: ${5*e.gridUnit}px;
  color: ${e.colors.grayscale.base};
`;function je({toast:e,onCloseToast:t}){const a=(0,n.useRef)(),[r,o]=(0,n.useState)(!1),s=()=>{o(!0)},i=(0,n.useCallback)((()=>{a.current&&clearTimeout(a.current),o((()=>(setTimeout((()=>{t(e.id)}),150),!1)))}),[t,e.id]);(0,n.useEffect)((()=>(setTimeout(s),e.duration>0&&(a.current=setTimeout(i,e.duration)),()=>{a.current&&clearTimeout(a.current)})),[i,e.duration]);let c="toast--success",l=(0,xe.tZ)(Ie.Z.CircleCheckSolid,{css:e=>Me(e)});return e.toastType===E.p.WARNING?(l=(0,xe.tZ)(Ie.Z.WarningSolid,{css:Me}),c="toast--warning"):e.toastType===E.p.DANGER?(l=(0,xe.tZ)(Ie.Z.ErrorSolid,{css:Me}),c="toast--danger"):e.toastType===E.p.INFO&&(l=(0,xe.tZ)(Ie.Z.InfoSolid,{css:Me}),c="toast--info"),(0,xe.tZ)(ke,{className:Ae()("alert","toast",r&&"toast--visible",c),role:"alert"},l,(0,xe.tZ)(De.ZP,{content:e.text}),(0,xe.tZ)("i",{className:"fa fa-close pull-right pointer",role:"button",tabIndex:0,onClick:i,"aria-label":"Close"}))}const Ue=Oe.iK.div`
  max-width: 600px;
  position: fixed;
  bottom: 0px;
  right: 0px;
  margin-right: 50px;
  margin-bottom: 50px;
  z-index: ${({theme:e})=>e.zIndex.max};
  word-break: break-word;

  .toast {
    background: ${({theme:e})=>e.colors.grayscale.dark1};
    border-radius: ${({theme:e})=>e.borderRadius};
    box-shadow: 0 2px 4px 0
      fade(
        ${({theme:e})=>e.colors.grayscale.dark2},
        ${({theme:e})=>e.opacity.mediumLight}
      );
    color: ${({theme:e})=>e.colors.grayscale.light5};
    opacity: 0;
    position: relative;
    transform: translateY(-100%);
    white-space: pre-line;
    will-change: transform, opacity;
    transition: transform ${({theme:e})=>e.transitionTiming}s,
      opacity ${({theme:e})=>e.transitionTiming}s;

    &:after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 6px;
      height: 100%;
    }
  }

  .toast > button {
    color: ${({theme:e})=>e.colors.grayscale.light5};
    opacity: 1;
  }

  .toast--visible {
    opacity: 1;
    transform: translateY(0);
  }
`,$e=(0,Ze.$j)((({messageToasts:e})=>({toasts:e})),(e=>(0,i.DE)({removeToast:S.RS},e)))((function({toasts:e,removeToast:t}){return e.length>0&&(0,xe.tZ)(Ue,{id:"toast-presenter"},e.map((e=>(0,xe.tZ)(je,{key:e.id,toast:e,onCloseToast:t}))))}));var Pe=a(19755),Fe=a.n(Pe),Le=a(98286),ze=a(92869),Ve=a(67663);function He({code:e,message:t}){return(0,xe.tZ)(n.Fragment,null,t," ",(0,xe.tZ)("a",{href:`https://superset.apache.org/docs/miscellaneous/issue-codes#issue-${e}`,rel:"noopener noreferrer",target:"_blank"},(0,xe.tZ)("i",{className:"fa fa-external-link"})))}var qe=a(91178);const Qe=function({error:e,source:t}){const{extra:a,level:r}=e,o=["dashboard","explore"].includes(t),s=o?(0,H.tn)("We’re having trouble loading this visualization. Queries are set to timeout after %s second.","We’re having trouble loading this visualization. Queries are set to timeout after %s seconds.",a.timeout,a.timeout):(0,H.tn)("We’re having trouble loading these results. Queries are set to timeout after %s second.","We’re having trouble loading these results. Queries are set to timeout after %s seconds.",a.timeout,a.timeout),i=(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)("p",null,(0,H.t)("This may be triggered by:"),(0,xe.tZ)("br",null),a.issue_codes.map((e=>(0,xe.tZ)(He,e))).reduce(((e,t)=>[e,(0,xe.tZ)("br",null),t]))),o&&a.owners&&(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)("br",null),(0,xe.tZ)("p",null,(0,H.tn)("Please reach out to the Chart Owner for assistance.","Please reach out to the Chart Owners for assistance.",a.owners.length)),(0,xe.tZ)("p",null,(0,H.tn)("Chart Owner: %s","Chart Owners: %s",a.owners.length,a.owners.join(", "))))),c=(0,H.t)("%(subtitle)s\nThis may be triggered by:\n %(issue)s",{subtitle:s,issue:a.issue_codes.map((e=>e.message)).join("\n")});return(0,xe.tZ)(qe.Z,{title:(0,H.t)("Timeout error"),subtitle:s,level:r,source:t,copyText:c,body:i})};var Be=a(5872),We=a.n(Be);const Ke=function({error:e,source:t="dashboard",subtitle:a}){const{extra:r,level:o,message:s}=e,i=["dashboard","explore"].includes(t),c=r&&(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)("p",null,(0,H.t)("This may be triggered by:"),(0,xe.tZ)("br",null),r.issue_codes.map((e=>(0,xe.tZ)(He,We()({},e,{key:e.code})))).reduce(((e,t)=>[e,(0,xe.tZ)("br",null),t]))),i&&r.owners&&(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)("br",null),(0,xe.tZ)("p",null,(0,H.tn)("Please reach out to the Chart Owner for assistance.","Please reach out to the Chart Owners for assistance.",r.owners.length)),(0,xe.tZ)("p",null,(0,H.tn)("Chart Owner: %s","Chart Owners: %s",r.owners.length,r.owners.join(", "))))),l=r&&r.issue_codes?(0,H.t)("%(message)s\nThis may be triggered by: \n%(issues)s",{message:s,issues:r.issue_codes.map((e=>e.message)).join("\n")}):s;return(0,xe.tZ)(qe.Z,{title:(0,H.t)("%s Error",r&&r.engine_name||(0,H.t)("DB engine")),subtitle:a,level:o,source:t,copyText:l,body:c})};var Ge=a(39991),Je=a.n(Ge);const Ye=function({error:e,source:t="sqllab",subtitle:a}){const{extra:r={issue_codes:[]},level:o,message:s}=e,i=(0,H.tn)("This was triggered by:","This may be triggered by:",r.issue_codes.length),c=((e,t)=>{const a={};return e.forEach((e=>{t.forEach((t=>{Je()(e,t)<=2&&(a[e]||(a[e]=[]),a[e].push(`"${t}"`))}))})),a})(r.undefined_parameters||[],Object.keys(r.template_parameters||{})),l=(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)("p",null,Object.keys(c).length>0&&(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)("p",null,(0,H.t)("Did you mean:")),(0,xe.tZ)("ul",null,Object.entries(c).map((([e,t])=>(0,xe.tZ)("li",null,(0,H.tn)('%(suggestion)s instead of "%(undefinedParameter)s?"','%(firstSuggestions)s or %(lastSuggestion)s instead of "%(undefinedParameter)s"?',t.length,{suggestion:t.join(", "),firstSuggestions:t.slice(0,-1).join(", "),lastSuggestion:t[t.length-1],undefinedParameter:e}))))),(0,xe.tZ)("br",null)),i,(0,xe.tZ)("br",null),r.issue_codes.length>0&&r.issue_codes.map((e=>(0,xe.tZ)(He,e))).reduce(((e,t)=>[e,(0,xe.tZ)("br",null),t])))),d=`${s}\n${i}\n${r.issue_codes.map((e=>e.message)).join("\n")}`;return(0,xe.tZ)(qe.Z,{title:(0,H.t)("Parameter error"),subtitle:a,level:o,source:t,copyText:d,body:l})},Xe=function({error:e,source:t="dashboard",subtitle:a}){const{level:r,message:o}=e;return(0,xe.tZ)(qe.Z,{title:(0,H.t)("Missing dataset"),subtitle:a,level:r,source:t,copyText:o,body:null})};var et=a(42522),tt=a(26009),at=a(45697),rt=a.n(at),ot=a(29119),nt=a(58593),st=a(67337);const it=e=>{(0,n.useEffect)(e,[])},ct=(e,t)=>{try{const a=localStorage.getItem(e);return JSON.parse(a||"null")||t}catch{return t}},lt=(e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch{}};var dt=a(27600),ut=a(50810),ht=a(2275),ft=a(1510),pt=a(40323);const mt=function(e){var t=[],a=null,r=function(){for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];t=o,a||(a=requestAnimationFrame((function(){a=null,e.apply(void 0,t)})))};return r.cancel=function(){a&&(cancelAnimationFrame(a),a=null)},r};var bt=a(91296),gt=a.n(bt),vt=a(93096),yt=a.n(vt),_t=function(e,t){return _t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},_t(e,t)};var St=function(){return St=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},St.apply(this,arguments)};var Et=function(e,t,a,r){switch(t){case"debounce":return gt()(e,a,r);case"throttle":return yt()(e,a,r);default:return e}},Zt=function(e){return"function"==typeof e},wt=function(){return"undefined"==typeof window},Ct=function(e){return e instanceof Element||e instanceof HTMLDocument};function Tt(e){void 0===e&&(e={});var t=e.skipOnMount,a=void 0!==t&&t,r=e.refreshMode,o=e.refreshRate,s=void 0===o?1e3:o,i=e.refreshOptions,c=e.handleWidth,l=void 0===c||c,d=e.handleHeight,u=void 0===d||d,h=e.onResize,f=(0,n.useRef)(null),p=(0,n.useRef)(),m=(0,n.useRef)(null),b=(0,n.useRef)(h);(0,n.useEffect)((function(){null===f.current&&(f.current=a)}),[a]);var g=(0,n.useState)({width:void 0,height:void 0}),v=g[0],y=g[1];return(0,n.useEffect)((function(){var e=function(e,t){return mt((function(a){var r=a.width,o=a.height;Zt(e)&&e(r,o),t({width:r,height:o})}))}(b.current,y);m.current=Et((function(t){(l||u)&&t.forEach((function(t){var a=t&&t.contentRect||{},r=a.width,o=a.height;!f.current&&!wt()&&e({width:r,height:o}),f.current=!1}))}),r,s,i);var t=new ResizeObserver(m.current);return p.current&&t.observe(p.current),function(){t.disconnect(),e.cancel();var a=m.current;a&&a.cancel&&a.cancel()}}),[r,s,i,l,u,b]),St({ref:p},v)}!function(e){function t(t){var a=e.call(this,t)||this;a.cancelHandler=function(){a.resizeHandler&&a.resizeHandler.cancel&&(a.resizeHandler.cancel(),a.resizeHandler=null)},a.rafClean=function(){a.raf&&a.raf.cancel&&(a.raf.cancel(),a.raf=null)},a.attachObserver=function(){var e=a.props.targetRef;e&&e.current&&(a.targetRef.current=e.current);var t=a.getElement();t&&(a.observableElement&&a.observableElement===t||(a.observableElement=t,a.resizeObserver.observe(t)))},a.getElement=function(){var e=a.props,t=e.querySelector,r=e.targetDomEl;if(wt())return null;if(t)return document.querySelector(t);if(r&&Ct(r))return r;if(a.targetRef&&Ct(a.targetRef.current))return a.targetRef.current;var o=(0,s.findDOMNode)(a);if(!o)return null;switch(a.getRenderType()){case"renderProp":case"childFunction":case"child":case"childArray":return o;default:return o.parentElement}},a.createUpdater=function(){return a.rafClean(),a.raf=mt((function(e){var t=e.width,r=e.height,o=a.props.onResize;o&&Zt(o)&&o(t,r),a.setState({width:t,height:r})})),a.raf},a.createResizeHandler=function(e){var t=a.state,r=t.width,o=t.height,n=a.props,s=n.handleWidth,i=void 0===s||s,c=n.handleHeight,l=void 0===c||c;if(i||l){var d=a.createUpdater();e.forEach((function(e){var t=e&&e.contentRect||{},n=t.width,s=t.height,c=i&&r!==n||l&&o!==s;!a.skipOnMount&&c&&!wt()&&d({width:n,height:s}),a.skipOnMount=!1}))}},a.getRenderType=function(){var e=a.props,t=e.render,r=e.children;return Zt(t)?"renderProp":Zt(r)?"childFunction":(0,n.isValidElement)(r)?"child":Array.isArray(r)?"childArray":"parent"};var r=t.skipOnMount,o=t.refreshMode,i=t.refreshRate,c=void 0===i?1e3:i,l=t.refreshOptions;return a.state={width:void 0,height:void 0},a.skipOnMount=r,a.raf=null,a.targetRef=(0,n.createRef)(),a.observableElement=null,a.resizeHandler=Et(a.createResizeHandler,o,c,l),a.resizeObserver=new ResizeObserver(a.resizeHandler),a}(function(e,t){function a(){this.constructor=e}_t(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)})(t,e),t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){this.resizeObserver.disconnect(),this.rafClean(),this.cancelHandler()},t.prototype.render=function(){var e,t=this.props,a=t.render,r=t.children,o=t.nodeType,s=void 0===o?"div":o,i=this.state,c={width:i.width,height:i.height,targetRef:this.targetRef};switch(this.getRenderType()){case"renderProp":return a&&a(c);case"childFunction":return(e=r)(c);case"child":if((e=r).type&&"string"==typeof e.type){var l=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(a[r[o]]=e[r[o]])}return a}(c,["targetRef"]);return(0,n.cloneElement)(e,l)}return(0,n.cloneElement)(e,c);case"childArray":return(e=r).map((function(e){return!!e&&(0,n.cloneElement)(e,c)}));default:return n.createElement(s,null)}}}(n.PureComponent);var Rt=a(5144),Ot=a(28062),xt=a(97860),Nt=a(93185),At=a(48600),Dt=a(38270),It=a(41609),kt=a.n(It),Mt=a(18446),jt=a.n(Mt),Ut=a(88306),$t=a.n(Ut),Pt=a(37687),Ft=a(92252);const Lt=$t()(((e,t)=>{const a={};return((null==t?void 0:t.controlPanelSections)||[]).forEach((e=>{e.controlSetRows.forEach((e=>{e.forEach((e=>{e&&("string"==typeof e?a[e]=Ft.ai[e]:e.name&&e.config&&(a[e.name]=e.config))}))}))})),a}));var zt=a(68073),Vt=a(76962);const Ht={origFormData:rt().object.isRequired,currentFormData:rt().object.isRequired};function qt(e){if(null==e||""===e)return null;if("object"==typeof e){if(Array.isArray(e)&&0===e.length)return null;const t=Object.keys(e);if(t&&0===t.length)return null}return e}class Qt extends n.Component{constructor(e){super(e);const t=this.getDiffs(e),a=(e=>{const t=(0,Pt.Z)().get(e);return Lt(e,t)})(this.props.origFormData.viz_type),r=this.getRowsFromDiffs(t,a);this.state={rows:r,hasDiffs:!kt()(t),controlsMap:a}}UNSAFE_componentWillReceiveProps(e){if(jt()(this.props,e))return;const t=this.getDiffs(e);this.setState((e=>({rows:this.getRowsFromDiffs(t,e.controlsMap),hasDiffs:!kt()(t)})))}getRowsFromDiffs(e,t){return Object.entries(e).map((([e,a])=>({control:t[e]&&t[e].label||e,before:this.formatValue(a.before,e,t),after:this.formatValue(a.after,e,t)})))}getDiffs(e){const t=e.origFormData,a=e.currentFormData,r=Object.keys(a),o={};return r.forEach((e=>{(t[e]||a[e])&&(["filters","having","having_filters","where"].includes(e)||this.isEqualish(t[e],a[e])||(o[e]={before:t[e],after:a[e]}))})),o}isEqualish(e,t){return jt()(qt(e),qt(t))}formatValue(e,t,a){var r,o,n;return void 0===e?"N/A":null===e?"null":"AdhocFilterControl"===(null==(r=a[t])?void 0:r.type)?e.length?e.map((e=>{const t=e.comparator&&e.comparator.constructor===Array?`[${e.comparator.join(", ")}]`:e.comparator;return`${e.subject} ${e.operator} ${t}`})).join(", "):"[]":"BoundsControl"===(null==(o=a[t])?void 0:o.type)?`Min: ${e[0]}, Max: ${e[1]}`:"CollectionControl"===(null==(n=a[t])?void 0:n.type)?e.map((e=>(0,h.o)(e))).join(", "):"boolean"==typeof e?e?"true":"false":e.constructor===Array?e.length?e.join(", "):"[]":"string"==typeof e||"number"==typeof e?e:(0,h.o)(e)}renderModalBody(){return(0,xe.tZ)(Vt.Z,{columns:[{accessor:"control",Header:"Control"},{accessor:"before",Header:"Before"},{accessor:"after",Header:"After"}],data:this.state.rows,pageSize:50,className:"table-condensed"})}renderTriggerNode(){return(0,xe.tZ)(nt.u,{id:"difference-tooltip",title:(0,H.t)("Click to see difference")},(0,xe.tZ)("span",{className:"label label-warning m-l-5",style:{fontSize:"12px"}},(0,H.t)("Altered")))}render(){return this.state.hasDiffs?(0,xe.tZ)(zt.Z,{triggerNode:this.renderTriggerNode(),modalTitle:(0,H.t)("Chart changes"),modalBody:this.renderModalBody(),responsive:!0}):null}}Qt.propTypes=Ht;const Bt=Oe.iK.a`
  font-size: ${({theme:e})=>e.typography.sizes.xl}px;
  display: flex;
  padding: 0 0 0 0.5em;
`,Wt=({itemId:e,isStarred:t,showTooltip:a,saveFaveStar:r,fetchFaveStar:o})=>{it((()=>{o&&o(e)}));const s=(0,n.useCallback)((a=>{a.preventDefault(),r(e,!!t)}),[t,e,r]),i=(0,xe.tZ)(Bt,{href:"#",onClick:s,className:"fave-unfave-icon",role:"button"},t?(0,xe.tZ)(Ie.Z.FavoriteSelected,{iconSize:"xxl"}):(0,xe.tZ)(Ie.Z.FavoriteUnselected,{iconSize:"xxl"}));return a?(0,xe.tZ)(nt.u,{id:"fave-unfave-tooltip",title:(0,H.t)("Click to favorite/unfavorite")},i):i};var Kt=a(37921),Gt=a(1836);const Jt=(0,Oe.iK)(Kt.Z)`
  text-align: left;
  width: 91px;
`;function Yt({endTime:e,isRunning:t,startTime:a,status:r="success"}){const[o,s]=(0,n.useState)("00:00:00.00"),i=(0,n.useRef)();return(0,n.useEffect)((()=>{const r=()=>{i.current&&(clearInterval(i.current),i.current=void 0)};return t&&(i.current=setInterval((()=>{if(a){const o=e||(0,Gt.zO)();a<o&&s((0,Gt.zQ)(a,o)),t||r()}}),30)),r}),[e,t,a]),(0,xe.tZ)(Jt,{type:r,role:"timer"},o)}var Xt=a(30381),ea=a.n(Xt);const ta=({cachedTimestamp:e})=>{const t=e?(0,xe.tZ)("span",null,(0,H.t)("Loaded data cached"),(0,xe.tZ)("b",null," ",ea().utc(e).fromNow())):(0,H.t)("Loaded from cache");return(0,xe.tZ)("span",null,t,". ",(0,H.t)("Click to force-refresh"))},aa=({className:e,onClick:t,cachedTimestamp:a})=>{const[r,o]=(0,n.useState)(!1),s=r?"primary":"default";return(0,xe.tZ)(nt.u,{title:(0,xe.tZ)(ta,{cachedTimestamp:a}),id:"cache-desc-tooltip"},(0,xe.tZ)(Kt.Z,{className:`${e}`,type:s,onClick:t,onMouseOver:()=>o(!0),onMouseOut:()=>o(!1)},(0,H.t)("cached")," ",(0,xe.tZ)("i",{className:"fa fa-refresh"})))};var ra=a(74069),oa=a(82191),na=a(35932),sa=a(4715),ia=a(15926),ca=a.n(ia);const la=oa.l0.Item,da=(0,Oe.iK)(oa.l0.Item)`
  margin-bottom: 0;
`,ua=Oe.iK.span`
  margin-bottom: 0;
`;function ha({slice:e,onHide:t,onSave:a,show:r}){const[o,s]=(0,n.useState)(!1),[i]=oa.l0.useForm(),[c,l]=(0,n.useState)(e.slice_name||""),[d,h]=(0,n.useState)(null);function f({error:e,statusText:t,message:a}){let r=e||t||(0,H.t)("An error has occurred");"Forbidden"===a&&(r=(0,H.t)("You do not have permission to edit this chart")),ra.Z.error({title:"Error",content:r,okButtonProps:{danger:!0,className:"btn-danger"}})}const p=(0,n.useCallback)((async function(){try{const t=(await u.Z.get({endpoint:`/api/v1/chart/${e.slice_id}`})).json.result;h(t.owners.map((e=>({value:e.id,label:`${e.first_name} ${e.last_name}`}))))}catch(e){f(await(0,Le.O)(e))}}),[e.slice_id]),m=(0,n.useMemo)((()=>(e="",t,a)=>{const r=ca().encode({filter:e,page:t,page_size:a});return u.Z.get({endpoint:`/api/v1/chart/related/owners?q=${r}`}).then((e=>({data:e.json.result.map((e=>({value:e.value,label:e.text}))),totalCount:e.json.count})))}),[]),b=(0,H.t)("Owners");return(0,n.useEffect)((()=>{p()}),[p]),(0,n.useEffect)((()=>{l(e.slice_name||"")}),[e.slice_name]),(0,xe.tZ)(ra.Z,{show:r,onHide:t,title:"Edit Chart Properties",footer:(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)(na.Z,{htmlType:"button",buttonSize:"small",onClick:t,cta:!0},(0,H.t)("Cancel")),(0,xe.tZ)(na.Z,{htmlType:"submit",buttonSize:"small",buttonStyle:"primary",onClick:i.submit,disabled:o||!c,cta:!0},(0,H.t)("Save"))),responsive:!0,wrapProps:{"data-test":"properties-edit-modal"}},(0,xe.tZ)(oa.l0,{form:i,onFinish:async r=>{s(!0);const{certified_by:o,certification_details:n,description:i,cache_timeout:l}=r,h={slice_name:c||null,description:i||null,cache_timeout:l||null,certified_by:o||null,certification_details:o&&n?n:null};d&&(h.owners=d.map((e=>e.value)));try{const r={...(await u.Z.put({endpoint:`/api/v1/chart/${e.slice_id}`,headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).json.result,id:e.slice_id};a(r),t()}catch(e){f(await(0,Le.O)(e))}s(!1)},layout:"vertical",initialValues:{name:e.slice_name||"",description:e.description||"",cache_timeout:null!=e.cache_timeout?e.cache_timeout:"",certified_by:e.certified_by||"",certification_details:e.certified_by&&e.certification_details?e.certification_details:""}},(0,xe.tZ)(oa.X2,{gutter:16},(0,xe.tZ)(oa.JX,{xs:24,md:12},(0,xe.tZ)("h3",null,(0,H.t)("Basic information")),(0,xe.tZ)(la,{label:(0,H.t)("Name"),required:!0},(0,xe.tZ)(oa.II,{"aria-label":(0,H.t)("Name"),name:"name",type:"text",value:c,onChange:e=>{var t;return l(null!=(t=e.target.value)?t:"")}})),(0,xe.tZ)(la,null,(0,xe.tZ)(da,{label:(0,H.t)("Description"),name:"description"},(0,xe.tZ)(oa.Kx,{rows:3,style:{maxWidth:"100%"}})),(0,xe.tZ)(ua,{className:"help-block"},(0,H.t)("The description can be displayed as widget headers in the dashboard view. Supports markdown."))),(0,xe.tZ)("h3",null,(0,H.t)("Certification")),(0,xe.tZ)(la,null,(0,xe.tZ)(da,{label:(0,H.t)("Certified by"),name:"certified_by"},(0,xe.tZ)(oa.II,null)),(0,xe.tZ)(ua,{className:"help-block"},(0,H.t)("Person or group that has certified this chart."))),(0,xe.tZ)(la,null,(0,xe.tZ)(da,{label:(0,H.t)("Certification details"),name:"certification_details"},(0,xe.tZ)(oa.II,null)),(0,xe.tZ)(ua,{className:"help-block"},(0,H.t)("Any additional detail to show in the certification tooltip.")))),(0,xe.tZ)(oa.JX,{xs:24,md:12},(0,xe.tZ)("h3",null,(0,H.t)("Configuration")),(0,xe.tZ)(la,null,(0,xe.tZ)(da,{label:(0,H.t)("Cache timeout"),name:"cacheTimeout"},(0,xe.tZ)(oa.II,null)),(0,xe.tZ)(ua,{className:"help-block"},(0,H.t)("Duration (in seconds) of the caching timeout for this chart. Note this defaults to the dataset's timeout if undefined."))),(0,xe.tZ)("h3",{style:{marginTop:"1em"}},(0,H.t)("Access")),(0,xe.tZ)(la,{label:b},(0,xe.tZ)(sa.P,{ariaLabel:b,mode:"multiple",name:"owners",value:d||[],onChange:h,options:m,disabled:!d,allowClear:!0}),(0,xe.tZ)(ua,{className:"help-block"},(0,H.t)("A list of users who can alter the chart. Searchable by name or username.")))))))}var fa=a(83268),pa=a(10222),ma=a(14114),ba=a(87189),ga=a(76697),va=a(49238),ya=a(13433),_a=a(23525);const Sa={latestQueryFormData:rt().object.isRequired};class Ea extends n.Component{constructor(e){super(e),this.state={height:"400",width:"600",shortUrlId:0},this.handleInputChange=this.handleInputChange.bind(this),this.getCopyUrl=this.getCopyUrl.bind(this),this.onShortUrlSuccess=this.onShortUrlSuccess.bind(this)}onShortUrlSuccess(e){const t=e.substring(e.indexOf("/r/")+3);this.setState((()=>({shortUrlId:t})))}getCopyUrl(){return(0,_a.O)((0,w.vp)(this.props.latestQueryFormData)).then(this.onShortUrlSuccess).catch(this.props.addDangerToast)}handleInputChange(e){const{value:t,name:a}=e.currentTarget,r={};r[a]=t,this.setState(r)}generateEmbedHTML(){const e=`${window.location.origin+(0,w.sW)()}?r=${this.state.shortUrlId}&${dt.KD.standalone.name}=1&height=${this.state.height}`;return`<iframe\n  width="${this.state.width}"\n  height="${this.state.height}"\n  seamless\n  frameBorder="0"\n  scrolling="no"\n  src="${e}"\n>\n</iframe>`}renderPopoverContent(){const e=this.generateEmbedHTML();return(0,xe.tZ)("div",{id:"embed-code-popover"},(0,xe.tZ)("div",{className:"row"},(0,xe.tZ)("div",{className:"col-sm-10"},(0,xe.tZ)("textarea",{name:"embedCode",value:e,rows:"4",readOnly:!0,className:"form-control input-sm"})),(0,xe.tZ)("div",{className:"col-sm-2"},(0,xe.tZ)(ya.Z,{shouldShowText:!1,text:e,copyNode:(0,xe.tZ)("i",{className:"fa fa-clipboard",title:(0,H.t)("Copy to clipboard")})}))),(0,xe.tZ)("br",null),(0,xe.tZ)("div",{className:"row"},(0,xe.tZ)("div",{className:"col-md-6 col-sm-12"},(0,xe.tZ)("div",{className:"form-group"},(0,xe.tZ)("small",null,(0,xe.tZ)(va.lX,{htmlFor:"embed-height"},(0,H.t)("Height"))),(0,xe.tZ)("input",{className:"form-control input-sm",type:"text",defaultValue:this.state.height,name:"height",onChange:this.handleInputChange}))),(0,xe.tZ)("div",{className:"col-md-6 col-sm-12"},(0,xe.tZ)("div",{className:"form-group"},(0,xe.tZ)("small",null,(0,xe.tZ)(va.lX,{htmlFor:"embed-width"},(0,H.t)("Width"))),(0,xe.tZ)("input",{className:"form-control input-sm",type:"text",defaultValue:this.state.width,name:"width",onChange:this.handleInputChange,id:"embed-width"})))))}render(){return(0,xe.tZ)(ga.Z,{trigger:"click",placement:"left",onClick:this.getCopyUrl,content:this.renderPopoverContent()},(0,xe.tZ)(nt.u,{id:"embed-code-tooltip",placement:"top",title:"Embed code",trigger:["hover"]},(0,xe.tZ)("div",{className:"btn btn-default btn-sm",style:{display:"flex",alignItems:"center",height:30}},(0,xe.tZ)(Ie.Z.Code,{iconSize:"l"}))))}}Ea.propTypes=Sa;var Za=a(56727),wa=a(15423);const Ca={onOpenPropertiesModal:rt().func,onOpenInEditor:rt().func,chartStatus:rt().string,latestQueryFormData:rt().object.isRequired,slice:rt().object},Ta="edit_properties",Ra="run_in_sql_lab",Oa="download_as_image",xa=e=>{const{datasource:t}=e.latestQueryFormData,a=t&&"table"===t.split("__")[1],{slice:r}=e;return(0,xe.tZ)(oa.Lt,{trigger:"click",overlay:(0,xe.tZ)(oa.v2,{onClick:({key:t,domEvent:a})=>{var r;const{slice:o,onOpenInEditor:n,latestQueryFormData:s}=e;switch(t){case Ta:e.onOpenPropertiesModal();break;case Ra:n(s);break;case Oa:(0,Za.Z)(".panel-body > .chart-container",null!=(r=null==o?void 0:o.slice_name)?r:(0,H.t)("New chart"),{},!0)(a)}},selectable:!1},r&&(0,xe.tZ)(oa.v2.Item,{key:Ta},(0,H.t)("Edit properties")),(0,xe.tZ)(oa.v2.Item,{key:"view_query"},(0,xe.tZ)(zt.Z,{triggerNode:(0,xe.tZ)("span",null,(0,H.t)("View query")),modalTitle:(0,H.t)("View query"),modalBody:(0,xe.tZ)(wa.Z,{latestQueryFormData:e.latestQueryFormData}),draggable:!0,resizable:!0,responsive:!0})),a&&(0,xe.tZ)(oa.v2.Item,{key:Ra},(0,H.t)("Run in SQL Lab")),(0,xe.tZ)(oa.v2.Item,{key:Oa},(0,H.t)("Download as image")))},(0,xe.tZ)("div",{role:"button",id:"query",tabIndex:0,className:"btn btn-default btn-sm"},(0,xe.tZ)("i",{role:"img",className:"fa fa-bars"})))};xa.propTypes=Ca;const Na=(0,Ze.$j)(null,(function(e){return(0,i.DE)({sliceUpdated:_e},e)}))(xa);var Aa={name:"yc7s2v",styles:"display:flex;align-items:center;&:focus, &:focus:active{outline:0;}"};const Da=e=>{const{icon:t,text:a,tooltip:r,className:o,onTooltipVisibilityChange:n,...s}=e;return(0,xe.tZ)(nt.u,{id:`${t}-tooltip`,placement:"top",title:r,trigger:["hover"],onVisibleChange:n},(0,xe.tZ)("div",We()({role:"button",tabIndex:0,css:Aa,className:o||"btn btn-default btn-sm",style:{height:30}},s),t,a&&(0,xe.tZ)("span",{style:{marginLeft:5}},a)))},Ia=(0,ma.Z)((e=>{const{actions:t,canDownloadCSV:a,chartStatus:r,latestQueryFormData:o,slice:s,addDangerToast:i}=e,c=(0,H.t)("Copy chart URL to clipboard"),[l,d]=(0,n.useState)(c),u=(0,w.vp)(o),h=(0,ba.n)(u),f=a?w.pe.bind(void 0,{formData:o,resultType:"full",resultFormat:"csv"}):null,p=w.pe.bind(void 0,{formData:o,resultType:"results",resultFormat:"json"}),m=Ae()("btn btn-default btn-sm",{disabled:!a});return(0,xe.tZ)("div",{className:"btn-group results",role:"group"},o&&(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)(Da,{icon:(0,xe.tZ)(Ie.Z.Link,{iconSize:"l"}),tooltip:l,onClick:async()=>{try{d((0,H.t)("Loading..."));const e=await h();await(0,pa.Z)(e),d((0,H.t)("Copied to clipboard!"))}catch(e){d((0,H.t)("Sorry, your browser does not support copying."))}},onTooltipVisibilityChange:e=>!e&&setTimeout((()=>d(c)),200)}),(0,xe.tZ)(Da,{icon:(0,xe.tZ)(Ie.Z.Email,{iconSize:"l"}),tooltip:(0,H.t)("Share chart by email"),onClick:async()=>{try{const e=(0,H.t)("Superset Chart"),t=await h(),a=(0,H.t)("%s%s","Check out this chart: ",t);window.location.href=`mailto:?Subject=${e}%20&Body=${a}`}catch(e){i((0,H.t)("Sorry, something went wrong. Try again later."))}}}),(0,xe.tZ)(Ea,{latestQueryFormData:o}),(0,xe.tZ)(Da,{icon:(0,xe.tZ)(Ie.Z.FileTextOutlined,{iconSize:"m"}),text:".JSON",tooltip:(0,H.t)("Export to .JSON format"),onClick:p}),(0,xe.tZ)(Da,{icon:(0,xe.tZ)(Ie.Z.FileExcelOutlined,{iconSize:"m"}),text:".CSV",tooltip:(0,H.t)("Export to .CSV format"),onClick:f,className:m})),(0,xe.tZ)(Na,{latestQueryFormData:o,chartStatus:r,onOpenInEditor:t.redirectSQLLab,onOpenPropertiesModal:t.openPropertiesModal,slice:s}))}));var ka=a(14086);const Ma={failed:"danger",loading:"warning",success:"success"},ja={actions:rt().object.isRequired,addHistory:rt().func,can_overwrite:rt().bool.isRequired,can_download:rt().bool.isRequired,dashboardId:rt().number,isStarred:rt().bool.isRequired,slice:rt().object,sliceName:rt().string,table_name:rt().string,form_data:rt().object,ownState:rt().object,timeout:rt().number,chart:ht.$6},Ua=Oe.iK.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  flex-wrap: wrap;
  justify-content: space-between;

  span[role='button'] {
    display: flex;
    height: 100%;
  }

  .title-panel {
    display: flex;
    align-items: center;
  }

  .right-button-panel {
    display: flex;
    align-items: center;

    > .btn-group {
      flex: 0 0 auto;
      margin-left: ${({theme:e})=>e.gridUnit}px;
    }
  }

  .action-button {
    color: ${({theme:e})=>e.colors.grayscale.base};
    margin: 0 ${({theme:e})=>1.5*e.gridUnit}px 0
      ${({theme:e})=>e.gridUnit}px;
  }
`,$a=Oe.iK.span`
  display: flex;
  align-items: center;
`;class Pa extends n.PureComponent{constructor(e){super(e),this.state={isPropertiesModalOpen:!1,showingReportModal:!1},this.openPropertiesModal=this.openPropertiesModal.bind(this),this.closePropertiesModal=this.closePropertiesModal.bind(this),this.showReportModal=this.showReportModal.bind(this),this.hideReportModal=this.hideReportModal.bind(this),this.renderReportModal=this.renderReportModal.bind(this),this.fetchChartDashboardData=this.fetchChartDashboardData.bind(this)}componentDidMount(){const{dashboardId:e}=this.props;if(this.canAddReports()){const{user:e,chart:t}=this.props;this.props.fetchUISpecificReport(e.userId,"chart_id","charts",t.id)}e&&this.fetchChartDashboardData()}async fetchChartDashboardData(){const{dashboardId:e,slice:t}=this.props,a=(await u.Z.get({endpoint:`/api/v1/chart/${t.slice_id}`})).json.result.dashboards||[],r=e&&a.length&&a.find((t=>t.id===e));if(r&&r.json_metadata){const e=JSON.parse(r.json_metadata).label_colors||{},t=Ot.getNamespace();Object.keys(e).forEach((a=>{t.setColor(a,e[a])}))}}getSliceName(){const{sliceName:e,table_name:t}=this.props;return e||(0,H.t)("%s - untitled",t)}postChartFormData(){this.props.actions.postChartFormData(this.props.form_data,!0,this.props.timeout,this.props.chart.id,this.props.ownState)}openPropertiesModal(){this.setState({isPropertiesModalOpen:!0})}closePropertiesModal(){this.setState({isPropertiesModalOpen:!1})}showReportModal(){this.setState({showingReportModal:!0})}hideReportModal(){this.setState({showingReportModal:!1})}renderReportModal(){return Object.keys(this.props.reports).length?(0,xe.tZ)(At.Z,{showReportModal:this.showReportModal,hideReportModal:this.hideReportModal,toggleActive:this.props.toggleActive,deleteActiveReport:this.props.deleteActiveReport}):(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)("span",{role:"button",title:(0,H.t)("Schedule email report"),tabIndex:0,className:"action-button",onClick:this.showReportModal},(0,xe.tZ)(Ie.Z.Calendar,null)))}canAddReports(){if(!(0,y.cr)(Nt.T.ALERT_REPORTS))return!1;const{user:e}=this.props;return!(null==e||!e.userId)&&Object.keys(e.roles||[]).map((t=>e.roles[t].filter((e=>"menu_access"===e[0]&&"Manage"===e[1]))))[0].length>0}render(){var e,t,a;const{user:r,form_data:o,slice:s}=this.props,{chartStatus:i,chartUpdateEndTime:c,chartUpdateStartTime:l,latestQueryFormData:d,queriesResponse:u}=this.props.chart,h=null==u?void 0:u[0],f=["failed","rendered","success"].includes(this.props.chart.chartStatus);return(0,xe.tZ)(Ua,{id:"slice-header",className:"panel-title-large"},(0,xe.tZ)("div",{className:"title-panel"},(null==s?void 0:s.certified_by)&&(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)(fa.Z,{certifiedBy:s.certified_by,details:s.certification_details})," "),(0,xe.tZ)(Dt.Z,{title:this.getSliceName(),canEdit:!this.props.slice||this.props.can_overwrite||((null==(e=this.props.slice)?void 0:e.owners)||[]).includes(null==(t=this.props)||null==(a=t.user)?void 0:a.userId),onSaveTitle:this.props.actions.updateChartTitle}),this.props.slice&&(0,xe.tZ)($a,null,r.userId&&(0,xe.tZ)(Wt,{itemId:this.props.slice.slice_id,fetchFaveStar:this.props.actions.fetchFaveStar,saveFaveStar:this.props.actions.saveFaveStar,isStarred:this.props.isStarred,showTooltip:!0}),this.state.isPropertiesModalOpen&&(0,xe.tZ)(ha,{show:this.state.isPropertiesModalOpen,onHide:this.closePropertiesModal,onSave:this.props.sliceUpdated,slice:this.props.slice}),(0,xe.tZ)(nt.u,{id:"edit-desc-tooltip",title:(0,H.t)("Edit chart properties")},(0,xe.tZ)("span",{"aria-label":(0,H.t)("Edit chart properties"),role:"button",tabIndex:0,className:"edit-desc-icon",onClick:this.openPropertiesModal},(0,xe.tZ)("i",{className:"fa fa-edit"}))),this.props.chart.sliceFormData&&(0,xe.tZ)(Qt,{className:"altered",origFormData:this.props.chart.sliceFormData,currentFormData:o}))),(0,xe.tZ)("div",{className:"right-button-panel"},f&&h&&(0,xe.tZ)(ka.Z,{rowcount:Number(h.rowcount)||0,limit:Number(o.row_limit)||0}),f&&h&&h.is_cached&&(0,xe.tZ)(aa,{onClick:this.postChartFormData.bind(this),cachedTimestamp:h.cached_dttm}),(0,xe.tZ)(Yt,{startTime:l,endTime:c,isRunning:"loading"===i,status:Ma[i]}),this.canAddReports()&&this.renderReportModal(),(0,xe.tZ)(xt.Z,{show:this.state.showingReportModal,onHide:this.hideReportModal,props:{userId:this.props.user.userId,userEmail:this.props.user.email,chart:this.props.chart,creationMethod:"charts"}}),(0,xe.tZ)(Ia,{actions:{...this.props.actions,openPropertiesModal:this.openPropertiesModal},slice:this.props.slice,canDownloadCSV:this.props.can_download,chartStatus:i,latestQueryFormData:d,queryResponse:h})))}}Pa.propTypes=ja;const Fa=(0,Ze.$j)(null,(function(e){return(0,i.DE)({sliceUpdated:_e,fetchUISpecificReport:R.Aw,toggleActive:R.M,deleteActiveReport:R.MZ},e)}))(Pa);var La=a(43700),za=a(40637),Va=a(38703),Ha=a(50909),qa=a(54076);const Qa="results",Ba="samples",Wa={[Qa]:void 0,[Ba]:void 0},Ka="is_datapanel_open",Ga="data",Ja=Oe.iK.div`
  display: flex;
  align-items: center;

  span {
    flex-shrink: 0;
  }
`,Ya=Oe.iK.div`
  position: relative;
  background-color: ${({theme:e})=>e.colors.grayscale.light5};
  z-index: 5;
  overflow: hidden;
`,Xa=Oe.iK.div`
  height: ${({contentHeight:e})=>e}px;
  overflow: hidden;

  .table-condensed {
    height: 100%;
    overflow: auto;
  }
`,er=Oe.iK.div`
  height: 100%;

  .collapse-inner {
    height: 100%;

    .ant-collapse-item {
      height: 100%;

      .ant-collapse-content {
        height: calc(100% - ${({theme:e})=>8*e.gridUnit}px);

        .ant-collapse-content-box {
          padding-top: 0;
          height: 100%;
        }
      }
    }
  }
`,tr=Oe.iK.pre`
  margin-top: ${({theme:e})=>4*e.gridUnit+"px"};
`,ar=({columnNames:e,filterText:t,data:a,isLoading:r,error:o,errorMessage:n})=>{const s=(0,Ha._q)(e,a),i=(0,Ha.C4)(t,a);return r?(0,xe.tZ)(Va.Z,null):o?(0,xe.tZ)(tr,null,o):a?0===a.length?(0,xe.tZ)("span",null,"No data"):(0,xe.tZ)(Vt.Z,{columns:s,data:i,pageSize:50,noDataText:(0,H.t)("No data"),emptyWrapperType:Vt.u.Small,className:"table-condensed",isPaginationSticky:!0,showRowCount:!1,small:!0}):n?(0,xe.tZ)(tr,null,n):null},rr=({queryFormData:e,tableSectionHeight:t,onCollapseChange:a,chartStatus:r,ownState:o,errorMessage:s,queriesResponse:i})=>{const[c,l]=(0,n.useState)(Wa),[d,u]=(0,n.useState)({[Qa]:!0,[Ba]:!0}),[h,f]=(0,n.useState)({[Qa]:[],[Ba]:[]}),[p,m]=(0,n.useState)(Wa),[b,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(Qa),[_,S]=(0,n.useState)(Wa),[E,Z]=(0,n.useState)(ct(Ka,!1)),w=(0,n.useMemo)((()=>({[Qa]:(0,qa.cD)(c.results),[Ba]:(0,qa.cD)(c.samples)})),[c]),C=(0,n.useCallback)((t=>(u((e=>({...e,[t]:!0}))),(0,z.getChartDataRequest)({formData:e,resultFormat:"json",resultType:t,ownState:o}).then((({json:e})=>{var a,r;if(e.result.length>1){const a=[];e.result.forEach((e=>{e.data.forEach(((e,t)=>{void 0!==a[t]?a[t]={...a[t],...e}:a[t]=e}))})),l((e=>({...e,[t]:a})))}else l((a=>({...a,[t]:e.result[0].data})));const o=null!=e&&null!=(a=e.result[0])&&null!=(r=a.data)&&r.length?Object.keys(e.result[0].data[0]):null;f((a=>({...a,[t]:e.result[0].columns||o}))),u((e=>({...e,[t]:!1}))),m((e=>({...e,[t]:null})))})).catch((e=>{(0,Le.O)(e).then((({error:e,message:a})=>{m((r=>({...r,[t]:e||a||(0,H.t)("Sorry, An error occurred")}))),u((e=>({...e,[t]:!1})))}))})))),[e,h]);(0,n.useEffect)((()=>{lt(Ka,E)}),[E]),(0,n.useEffect)((()=>{S((e=>({...e,[Qa]:!0})))}),[e]),(0,n.useEffect)((()=>{S((e=>({...e,[Ba]:!0})))}),[null==e?void 0:e.adhoc_filters,null==e?void 0:e.datasource]),(0,n.useEffect)((()=>{if(i&&"success"===r){const{colnames:e}=i[0];f({...h,[Qa]:[...e]})}}),[i]),(0,n.useEffect)((()=>{if(E&&_.results){if(s)return S((e=>({...e,[Qa]:!1}))),void u((e=>({...e,[Qa]:!1})));"loading"===r?u((e=>({...e,[Qa]:!0}))):(S((e=>({...e,[Qa]:!1}))),C(Qa))}E&&_.samples&&v===Ba&&(S((e=>({...e,[Ba]:!1}))),C(Ba))}),[E,_,C,v,r,s]);const T=(0,xe.tZ)(Ja,null,(0,xe.tZ)(Ha.uy,{data:c[v],loading:d[v]}),(0,xe.tZ)(Ha.m,{data:w[v],columns:h[v]}),(0,xe.tZ)(Ha.HS,{onChangeHandler:g}));return(0,xe.tZ)(Ya,null,(0,xe.tZ)(Xa,{contentHeight:t},(0,xe.tZ)(er,null,(0,xe.tZ)(La.Z,{accordion:!0,bordered:!1,defaultActiveKey:E?Ga:void 0,onChange:e=>{a(e),Z(!!e)},bold:!0,ghost:!0,className:"collapse-inner"},(0,xe.tZ)(La.Z.Panel,{header:(0,H.t)("Data"),key:Ga},(0,xe.tZ)(za.ZP,{fullWidth:!1,tabBarExtraContent:T,activeKey:v,onChange:y},(0,xe.tZ)(za.ZP.TabPane,{tab:(0,H.t)("View results"),key:Qa},(0,xe.tZ)(ar,{isLoading:d.results,data:c.results,columnNames:h.results,filterText:b,error:p.results,errorMessage:s})),(0,xe.tZ)(za.ZP.TabPane,{tab:(0,H.t)("View samples"),key:Ba},(0,xe.tZ)(ar,{isLoading:d.samples,data:c.samples,columnNames:h.samples,filterText:b,error:p.samples,errorMessage:s}))))))))},or={actions:rt().object.isRequired,addHistory:rt().func,onQuery:rt().func,can_overwrite:rt().bool.isRequired,can_download:rt().bool.isRequired,datasource:rt().object,dashboardId:rt().number,column_formats:rt().object,containerId:rt().string.isRequired,height:rt().string.isRequired,width:rt().string.isRequired,isStarred:rt().bool.isRequired,slice:rt().object,sliceName:rt().string,table_name:rt().string,vizType:rt().string.isRequired,form_data:rt().object,ownState:rt().object,standalone:rt().number,timeout:rt().number,refreshOverlayVisible:rt().bool,chart:ht.$6,errorMessage:rt().node,triggerRender:rt().bool},nr=1.25,sr="chart_split_sizes",ir=[90,10],cr=[300,50],lr=Oe.iK.div`
  display: flex;
  flex-direction: column;
  align-items: stretch;
  align-content: stretch;
  overflow: auto;
  box-shadow: none;
  height: 100%;

  & > div:last-of-type {
    flex-basis: 100%;
  }

  .gutter {
    border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    border-bottom: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    width: ${({theme:e})=>9*e.gridUnit}px;
    margin: ${({theme:e})=>e.gridUnit*nr}px auto;
  }

  .gutter.gutter-vertical {
    cursor: row-resize;
  }

  .ant-collapse {
    .ant-tabs {
      height: 100%;
      .ant-tabs-nav {
        padding-left: ${({theme:e})=>5*e.gridUnit}px;
        margin: 0;
      }
      .ant-tabs-content-holder {
        overflow: hidden;
        .ant-tabs-content {
          height: 100%;
        }
      }
    }
  }
`,dr=e=>{const t=(0,Oe.Fg)(),a=t.gridUnit*nr,r=t.gridUnit*nr,{height:o,ref:s}=Tt({refreshMode:"debounce",refreshRate:300}),{width:i,ref:c}=Tt({refreshMode:"debounce",refreshRate:300}),[l,d]=(0,n.useState)(ct(sr,ir)),{slice:h}=e,f=(0,n.useCallback)((async function(){if(h&&null===h.query_context){const e=(0,w.u)({formData:h.form_data,force:!1,resultFormat:"json",resultType:"full",setDataMask:null,ownState:null});await u.Z.put({endpoint:`/api/v1/chart/${h.slice_id}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({query_context:JSON.stringify(e),query_context_generation:!0})})}}),[h]);(0,n.useEffect)((()=>{f()}),[f]);const p=(0,n.useCallback)((t=>{let n;return n=e.standalone?0:o?o+15:50,(parseInt(e.height,10)-n)*t/100-(r/2+a)}),[r,a,e.height,e.standalone,o]),[m,b]=(0,n.useState)(p(ir[1])),g=(0,n.useCallback)((([,e])=>{b(p(e))}),[p]);(0,n.useEffect)((()=>{g(l)}),[g,l]),(0,n.useEffect)((()=>{lt(sr,l)}),[l]);const v=(0,n.useCallback)((()=>{const{chart:t,vizType:a}=e,r="filter_box"===a?p(100)-15:p(l[0])-15,o=i-30;return o>0&&(0,xe.tZ)(Rt.Z,{width:Math.floor(o),height:r,ownState:e.ownState,annotationData:t.annotationData,chartAlert:t.chartAlert,chartStackTrace:t.chartStackTrace,chartId:t.id,chartStatus:t.chartStatus,triggerRender:e.triggerRender,datasource:e.datasource,errorMessage:e.errorMessage,formData:e.form_data,onQuery:e.onQuery,queriesResponse:t.queriesResponse,refreshOverlayVisible:e.refreshOverlayVisible,setControlValue:e.actions.setControlValue,timeout:e.timeout,triggerQuery:t.triggerQuery,vizType:e.vizType})}),[p,i,e,l]),y=(0,n.useMemo)((()=>(0,xe.tZ)("div",{className:"panel-body",ref:c},v())),[c,v]),_=(0,n.useMemo)((()=>(0,xe.tZ)("div",{ref:c},v())),[c,v]),[S,E]=(0,n.useState)(e.chart.latestQueryFormData);if((0,n.useEffect)((()=>{e.triggerRender||E(e.chart.latestQueryFormData)}),[e.chart.latestQueryFormData]),e.standalone){const e="background-transparent";return document.body.className.split(" ").includes(e)||(document.body.className+=` ${e}`),_}const Z=(0,xe.tZ)(Fa,{ownState:e.ownState,actions:e.actions,addHistory:e.addHistory,can_overwrite:e.can_overwrite,can_download:e.can_download,dashboardId:e.dashboardId,isStarred:e.isStarred,slice:e.slice,sliceName:e.sliceName,table_name:e.table_name,form_data:e.form_data,timeout:e.timeout,chart:e.chart,user:e.user,reports:e.reports});return(0,xe.tZ)(lr,{className:"panel panel-default chart-container",ref:c},(0,xe.tZ)("div",{className:"panel-heading",ref:s},Z),"filter_box"===e.vizType?y:(0,xe.tZ)(pt.Z,{sizes:l,minSize:cr,direction:"vertical",gutterSize:r,onDragEnd:e=>{d(e)},elementStyle:(e,t,r)=>({[e]:`calc(${t}% - ${r+a}px)`})},y,(0,xe.tZ)(rr,{ownState:e.ownState,queryFormData:S,tableSectionHeight:m,onCollapseChange:e=>{let t;t=e?[60,40]:ir,d(t)},chartStatus:e.chart.chartStatus,errorMessage:e.errorMessage,queriesResponse:e.chart.queriesResponse})))};dr.propTypes=or;const ur=dr;var hr=a(46078),fr=a(55786),pr=a(60485),mr=a(9882),br=a(61357),gr=a(88453);const vr=Oe.iK.div`
  height: 100%;
  width: 100%;
  overflow: auto;
  overflow-x: visible;
  overflow-y: auto;
  #controlSections {
    min-height: 100%;
    overflow: visible;
  }
  .nav-tabs {
    flex: 0 0 1;
  }
  .tab-content {
    overflow: auto;
    flex: 1 1 100%;
  }
  .Select__menu {
    max-width: 100%;
  }
  .type-label {
    margin-right: ${({theme:e})=>3*e.gridUnit}px;
    width: ${({theme:e})=>7*e.gridUnit}px;
    display: inline-block;
    text-align: center;
    font-weight: ${({theme:e})=>e.typography.weights.bold};
  }
`,yr=(0,Oe.iK)(za.ZP)`
  .ant-tabs-nav-list {
    width: ${({fullWidth:e})=>e?"100%":"50%"};
  }
  .ant-tabs-content-holder {
    overflow: visible;
  }
  .ant-tabs-tabpane {
    height: 100%;
  }
`,_r=(e,t)=>e.reduce(((e,a)=>!a.expanded||(e=>!!e.label&&(pr.sections.legacyRegularTime.label===e.label||pr.sections.legacyTimeseriesTime.label===e.label))(a)&&!(e=>{var t;return(null==e||null==(t=e.columns)?void 0:t.some((e=>e.is_dttm)))||e.type===hr.i.Druid})(t)?e:[...e,String(a.label)]),[]);function Sr(e){const{exploreState:{datasource:t}}=e,a=[],r=[];return(0,T.Bq)(e.form_data.viz_type,e.datasource_type).forEach((e=>{"data"===e.tabOverride||e.controlSetRows.some((e=>e.some((e=>e&&"object"==typeof e&&"config"in e&&e.config&&(!e.config.renderTrigger||"data"===e.config.tabOverride)))))?a.push(e):r.push(e)})),{expandedQuerySections:_r(a,t),expandedCustomizeSections:_r(r,t),querySections:a,customizeSections:r,loading:!1}}class Er extends n.Component{constructor(e){super(e),this.state={expandedQuerySections:[],expandedCustomizeSections:[],querySections:[],customizeSections:[],loading:!1},this.renderControl=this.renderControl.bind(this),this.renderControlPanelSection=this.renderControlPanelSection.bind(this)}componentDidUpdate(e){this.props.form_data.datasource===e.form_data.datasource&&this.props.form_data.viz_type===e.form_data.viz_type||this.setState(Sr(this.props))}UNSAFE_componentWillReceiveProps(e){this.props.form_data.datasource===e.form_data.datasource&&this.props.form_data.viz_type===e.form_data.viz_type||this.setState({loading:!0})}componentDidMount(){this.setState(Sr(this.props))}renderControl({name:e,config:t}){var a;const{actions:r,controls:o,chart:n,exploreState:s}=this.props,{visibility:i}=t,c={...t,...o[e],...3===(null==(a=t.mapStateToProps)?void 0:a.length)?t.mapStateToProps(s,o[e],n):void 0,name:e},{validationErrors:l,...d}=c;return i&&!i.call(t,this.props,c)?null:(0,xe.tZ)(gr.Z,We()({key:`control-${e}`,name:e,validationErrors:l,actions:r},d))}renderControlPanelSection(e){const{controls:t}=this.props,{label:a,description:r}=e,o=String(a),s=e.controlSetRows.some((e=>e.some((e=>{const a="string"==typeof e?e:e&&"name"in e?e.name:null;return a&&a in t&&t[a].validationErrors&&t[a].validationErrors.length>0}))));return(0,xe.tZ)(La.Z.Panel,{css:e=>xe.iv`
          margin-bottom: 0;
          box-shadow: none;

          &:last-child {
            padding-bottom: ${10*e.gridUnit}px;
          }

          .panel-body {
            margin-left: ${4*e.gridUnit}px;
            padding-bottom: 0px;
          }

          span.label {
            display: inline-block;
          }
        `,header:(0,xe.tZ)("span",null,(0,xe.tZ)("span",null,a)," ",r&&(0,xe.tZ)(mr.V,{label:o,tooltip:r}),s&&(0,xe.tZ)(mr.V,{label:"validation-errors",bsStyle:"danger",tooltip:"This section contains validation errors"})),key:o},e.controlSetRows.map(((e,t)=>{const a=e.map((e=>e?n.isValidElement(e)?e:e.name&&e.config&&"datasource"!==e.name?this.renderControl(e):null:null)).filter((e=>null!==e));return 0===a.length?null:(0,xe.tZ)(br.Z,{key:`controlsetrow-${t}`,controls:a})})))}render(){if(!(0,Pt.Z)().has(this.props.form_data.viz_type)&&this.context.loading||this.state.loading)return(0,xe.tZ)(Va.Z,null);const e=this.state.customizeSections.length>0;return(0,xe.tZ)(vr,null,(0,xe.tZ)(yr,{id:"controlSections",fullWidth:e},(0,xe.tZ)(za.ZP.TabPane,{key:"query",tab:(0,H.t)("Data")},(0,xe.tZ)(La.Z,{bordered:!0,activeKey:this.state.expandedQuerySections,expandIconPosition:"right",onChange:e=>{this.setState({expandedQuerySections:(0,fr.Z)(e)})},ghost:!0},this.state.querySections.map(this.renderControlPanelSection))),e&&(0,xe.tZ)(za.ZP.TabPane,{key:"display",tab:(0,H.t)("Customize")},(0,xe.tZ)(La.Z,{bordered:!0,activeKey:this.state.expandedCustomizeSections,expandIconPosition:"right",onChange:e=>{this.setState({expandedCustomizeSections:(0,fr.Z)(e)})},ghost:!0},this.state.customizeSections.map(this.renderControlPanelSection)))))}}Er.contextType=Re.Zn;const Zr=(0,Ze.$j)((function(e){const{explore:t,charts:a}=e;return{chart:a[Object.keys(a)[0]],isDatasourceMetaLoading:t.isDatasourceMetaLoading,controls:t.controls,exploreState:t}}),(function(e){return{actions:(0,i.DE)(Se,e)}}))(Er);var wr=a(29487),Cr=a(30724),Tr=a.n(Cr),Rr=a(87183);const Or="save_chart_recent_dashboard",xr=(0,H.t)("**Select** a dashboard OR **create** a new one"),Nr=(0,Oe.iK)(ra.Z)`
  .ant-modal-body {
    overflow: visible;
  }
`;class Ar extends n.Component{constructor(e){super(e),this.state={saveToDashboardId:null,newSliceName:e.sliceName,alert:null,action:this.canOverwriteSlice()?"overwrite":"saveas"},this.onDashboardSelectChange=this.onDashboardSelectChange.bind(this),this.onSliceNameChange=this.onSliceNameChange.bind(this),this.changeAction=this.changeAction.bind(this),this.saveOrOverwrite=this.saveOrOverwrite.bind(this)}canOverwriteSlice(){var e,t;return null==(e=this.props.slice)||null==(t=e.owners)?void 0:t.includes(this.props.userId)}componentDidMount(){this.props.actions.fetchDashboards(this.props.userId).then((()=>{const e=this.props.dashboards.map((e=>e.value)),t=sessionStorage.getItem(Or);let a=t&&parseInt(t,10);this.props.dashboardId&&(a=this.props.dashboardId),null!==a&&-1!==e.indexOf(a)&&this.setState({saveToDashboardId:a})}))}onSliceNameChange(e){this.setState({newSliceName:e.target.value})}onDashboardSelectChange(e){const t=e?String(e):void 0,a=e&&"number"==typeof e?e:null;this.setState({saveToDashboardId:a,newDashboardName:t})}changeAction(e){this.setState({action:e})}saveOrOverwrite(e){this.setState({alert:null}),this.props.actions.removeSaveModalAlert();const t={};this.props.slice&&this.props.slice.slice_id&&(t.slice_id=this.props.slice.slice_id),"saveas"!==t.action||""!==this.state.newSliceName?(t.action=this.state.action,t.slice_name=this.state.newSliceName,t.save_to_dashboard_id=this.state.saveToDashboardId,t.new_dashboard_name=this.state.newDashboardName,this.props.actions.saveSlice(this.props.form_data,t).then((t=>{null===t.dashboard_id?sessionStorage.removeItem(Or):sessionStorage.setItem(Or,t.dashboard_id);const a=e?t.dashboard_url:t.slice.slice_url;window.location.assign(a)})),this.props.onHide()):this.setState({alert:(0,H.t)("Please enter a chart name")})}removeAlert(){this.props.alert&&this.props.actions.removeSaveModalAlert(),this.setState({alert:null})}render(){const e=this.state.saveToDashboardId||this.state.newDashboardName;return(0,xe.tZ)(Nr,{show:!0,onHide:this.props.onHide,title:(0,H.t)("Save chart"),footer:(0,xe.tZ)("div",null,(0,xe.tZ)(na.Z,{id:"btn_cancel",buttonSize:"small",onClick:this.props.onHide},(0,H.t)("Cancel")),(0,xe.tZ)(na.Z,{id:"btn_modal_save_goto_dash",buttonSize:"small",disabled:!this.state.newSliceName||!this.state.saveToDashboardId&&!this.state.newDashboardName,onClick:()=>this.saveOrOverwrite(!0)},(0,H.t)("Save & go to dashboard")),(0,xe.tZ)(na.Z,{id:"btn_modal_save",buttonSize:"small",buttonStyle:"primary",onClick:()=>this.saveOrOverwrite(!1),disabled:!this.state.newSliceName},!this.canOverwriteSlice()&&this.props.slice?(0,H.t)("Save as new chart"):(0,H.t)("Save")))},(0,xe.tZ)(va.l0,{layout:"vertical"},(this.state.alert||this.props.alert)&&(0,xe.tZ)(wr.Z,{type:"warning",message:(0,xe.tZ)(n.Fragment,null,this.state.alert?this.state.alert:this.props.alert,(0,xe.tZ)("i",{role:"button","aria-label":"Remove alert",tabIndex:0,className:"fa fa-close pull-right",onClick:this.removeAlert.bind(this),style:{cursor:"pointer"}}))}),(0,xe.tZ)(va.xJ,null,(0,xe.tZ)(Rr.Y,{id:"overwrite-radio",disabled:!this.canOverwriteSlice(),checked:"overwrite"===this.state.action,onChange:()=>this.changeAction("overwrite")},(0,H.t)("Save (Overwrite)")),(0,xe.tZ)(Rr.Y,{id:"saveas-radio",checked:"saveas"===this.state.action,onChange:()=>this.changeAction("saveas")}," ",(0,H.t)("Save as ..."),"  ")),(0,xe.tZ)("hr",null),(0,xe.tZ)(va.xJ,{label:(0,H.t)("Chart name"),required:!0},(0,xe.tZ)(oa.II,{name:"new_slice_name",type:"text",placeholder:"Name",value:this.state.newSliceName,onChange:this.onSliceNameChange})),(0,xe.tZ)(va.xJ,{label:(0,H.t)("Add to dashboard")},(0,xe.tZ)(sa.P,{allowClear:!0,allowNewOptions:!0,ariaLabel:(0,H.t)("Select a dashboard"),options:this.props.dashboards,onChange:this.onDashboardSelectChange,value:e||void 0,placeholder:(0,xe.tZ)(Tr(),{source:xr,renderers:{paragraph:"span"}})}))))}}const Dr=(0,Ze.$j)((function({explore:e,saveModal:t}){var a;return{datasource:e.datasource,slice:e.slice,userId:null==(a=e.user)?void 0:a.userId,dashboards:t.dashboards,alert:t.saveModalAlert}}),(()=>({})))(Ar);var Ir=a(37488);const kr={canAdd:rt().bool.isRequired,onQuery:rt().func.isRequired,onSave:rt().func,onStop:rt().func,loading:rt().bool,chartIsStale:rt().bool,errorMessage:rt().node};function Mr({canAdd:e,onQuery:t,onSave:a,onStop:r,loading:o,chartIsStale:n,errorMessage:s}){let i="tertiary";s?i="danger":n&&(i="primary");const c=!!s||o,l=o?(0,xe.tZ)(na.Z,{onClick:r,buttonStyle:"warning",buttonSize:"small",disabled:!e},(0,xe.tZ)("i",{className:"fa fa-stop-circle-o"})," ",(0,H.t)("Stop")):(0,xe.tZ)(na.Z,{buttonSize:"small",onClick:t,buttonStyle:i,disabled:!!s},(0,xe.tZ)("i",{className:"fa fa-bolt"})," ",(0,H.t)("Run")),d=(0,Oe.Fg)();return(0,xe.tZ)("div",{css:(0,xe.iv)({display:"flex",flexShrink:0,flexDirection:"row",alignItems:"center",paddingTop:2*d.gridUnit,paddingRight:2*d.gridUnit,paddingBottom:0,paddingLeft:4*d.gridUnit,"& button":{width:100},".errMsg":{marginLeft:4*d.gridUnit}},"","")},(0,xe.tZ)(Ir.Z,{className:"query-and-save"},l,(0,xe.tZ)(na.Z,{buttonStyle:"tertiary",buttonSize:"small","data-target":"#save_modal","data-toggle":"modal",disabled:c,onClick:a},(0,xe.tZ)("i",{className:"fa fa-plus-circle"})," ",(0,H.t)("Save"))),s&&(0,xe.tZ)("span",{className:"errMsg"}," ",(0,xe.tZ)(nt.u,{id:"query-error-tooltip",placement:"right",title:s},(0,xe.tZ)("i",{className:"fa fa-exclamation-circle text-danger fa-lg"}))))}Mr.propTypes=kr,Mr.defaultProps={onStop:()=>{},onSave:()=>{}},a(15306);var jr=a(90233),Ur=a(27034),$r=a(42753),Pr=a(99963);const Fr=Oe.iK.div`
  display: flex;
  align-items: center;
  width: 100%;
  height: ${({theme:e})=>6*e.gridUnit}px;
  cursor: pointer;

  > div {
    width: 100%;
  }

  :hover {
    background-color: ${({theme:e})=>e.colors.grayscale.light2};
  }
`;function Lr(e){const{labelRef:t,showTooltip:a,type:r,value:o}=e,[{isDragging:n},s]=(0,Ur.c)({item:{value:e.value,type:e.type},collect:e=>({isDragging:e.isDragging()})}),i={labelRef:t,showTooltip:!n&&a,showType:!0};return(0,xe.tZ)(Fr,{ref:s},r===$r.g.Column?(0,xe.tZ)(Pr.l,We()({column:o},i)):(0,xe.tZ)(Pr.B,We()({metric:o},i)))}const zr=Oe.iK.button`
  background: none;
  border: none;
  text-decoration: underline;
  color: ${({theme:e})=>e.colors.primary.dark1};
`,Vr=Oe.iK.div`
  text-align: center;
  padding-top: 2px;
`,Hr=Oe.iK.div`
  ${({theme:e})=>xe.iv`
    background-color: ${e.colors.grayscale.light4};
    position: relative;
    height: 100%;
    display: flex;
    flex-direction: column;
    max-height: 100%;
    .ant-collapse {
      height: auto;
    }
    .field-selections {
      padding: 0 0 ${4*e.gridUnit}px;
      overflow: auto;
    }
    .field-length {
      margin-bottom: ${2*e.gridUnit}px;
      font-size: ${e.typography.sizes.s}px;
      color: ${e.colors.grayscale.light1};
    }
    .form-control.input-md {
      width: calc(100% - ${4*e.gridUnit}px);
      height: ${8*e.gridUnit}px;
      margin: ${2*e.gridUnit}px auto;
    }
    .type-label {
      font-weight: ${e.typography.weights.light};
      font-size: ${e.typography.sizes.s}px;
      color: ${e.colors.grayscale.base};
    }
    .Control {
      padding-bottom: 0;
    }
  `};
`,qr=Oe.iK.div`
  overflow: hidden;
  text-overflow: ellipsis;

  & > span {
    white-space: nowrap;
  }

  .option-label {
    display: inline;
  }

  .metric-option {
    & > svg {
      min-width: ${({theme:e})=>4*e.gridUnit+"px"};
    }
    & > .option-label {
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,Qr=e=>{const t=(0,n.useRef)(null),[a,r]=(0,n.useState)(!0),o={labelRef:t,showTooltip:a};return(0,xe.tZ)(qr,{onMouseEnter:()=>{const e=!!(t&&t.current&&t.current.scrollWidth>t.current.clientWidth);e!==a&&r(e)},onMouseLeave:()=>{r(!0)},className:e.className},n.cloneElement(e.children,o))},Br=(0,y.cr)(Nt.T.ENABLE_EXPLORE_DRAG_AND_DROP);function Wr({datasource:e,controls:{datasource:t},actions:a}){const{columns:r,metrics:o}=e,s=(0,n.useMemo)((()=>[...r].sort(((e,t)=>e.is_dttm&&!t.is_dttm?-1:t.is_dttm&&!e.is_dttm?1:0))),[r]),[i,c]=(0,n.useState)(""),[l,d]=(0,n.useState)({columns:s,metrics:o}),[u,h]=(0,n.useState)(!1),[f,p]=(0,n.useState)(!1),m=(0,n.useMemo)((()=>b()((e=>{d(""!==e?{columns:(0,jr.Lu)(s,e,{keys:[{key:"verbose_name",threshold:jr.tL.CONTAINS},{key:"column_name",threshold:jr.tL.CONTAINS},{key:e=>[e.description,e.expression].map((e=>(null==e?void 0:e.replace(/[_\n\s]+/g," "))||"")),threshold:jr.tL.CONTAINS,maxRanking:jr.tL.CONTAINS}],keepDiacritics:!0}),metrics:(0,jr.Lu)(o,e,{keys:[{key:"verbose_name",threshold:jr.tL.CONTAINS},{key:"metric_name",threshold:jr.tL.CONTAINS},{key:e=>[e.description,e.expression].map((e=>(null==e?void 0:e.replace(/[_\n\s]+/g," "))||"")),threshold:jr.tL.CONTAINS,maxRanking:jr.tL.CONTAINS}],keepDiacritics:!0,baseSort:(e,t)=>Number(t.item.is_certified)-Number(e.item.is_certified)||String(e.rankedValue).localeCompare(t.rankedValue)})}:{columns:s,metrics:o})}),dt.oP)),[s,o]);(0,n.useEffect)((()=>{d({columns:s,metrics:o}),c("")}),[s,e,o]);const g=(0,n.useMemo)((()=>u?l.metrics:l.metrics.slice(0,50)),[l.metrics,u]),v=(0,n.useMemo)((()=>(f?l.columns:l.columns.slice(0,50)).sort(((e,t)=>t.is_certified-e.is_certified))),[l.columns,f]),y=(0,n.useMemo)((()=>(0,xe.tZ)(n.Fragment,null,(0,xe.tZ)(oa.II,{allowClear:!0,onChange:e=>{c(e.target.value),m(e.target.value)},value:i,className:"form-control input-md",placeholder:(0,H.t)("Search Metrics & Columns")}),(0,xe.tZ)("div",{className:"field-selections"},(0,xe.tZ)(La.Z,{bordered:!0,defaultActiveKey:["metrics","column"],expandIconPosition:"right",ghost:!0},(0,xe.tZ)(La.Z.Panel,{header:(0,xe.tZ)("span",{className:"header"},(0,H.t)("Metrics")),key:"metrics"},(0,xe.tZ)("div",{className:"field-length"},(0,H.t)("Showing %s of %s",g.length,l.metrics.length)),g.map((e=>(0,xe.tZ)(Qr,{key:e.metric_name,className:"column"},Br?(0,xe.tZ)(Lr,{value:e,type:$r.g.Metric}):(0,xe.tZ)(Pr.B,{metric:e,showType:!0})))),l.metrics.length>50?(0,xe.tZ)(Vr,null,(0,xe.tZ)(zr,{onClick:()=>h(!u)},u?(0,H.t)("Show less..."):(0,H.t)("Show all..."))):(0,xe.tZ)(n.Fragment,null)),(0,xe.tZ)(La.Z.Panel,{header:(0,xe.tZ)("span",{className:"header"},(0,H.t)("Columns")),key:"column"},(0,xe.tZ)("div",{className:"field-length"},(0,H.t)("Showing %s of %s",v.length,l.columns.length)),v.map((e=>(0,xe.tZ)(Qr,{key:e.column_name,className:"column"},Br?(0,xe.tZ)(Lr,{value:e,type:$r.g.Column}):(0,xe.tZ)(Pr.l,{column:e,showType:!0})))),l.columns.length>50?(0,xe.tZ)(Vr,null,(0,xe.tZ)(zr,{onClick:()=>p(!f)},f?(0,H.t)("Show Less..."):(0,H.t)("Show all..."))):(0,xe.tZ)(n.Fragment,null)))))),[v,i,l.columns.length,l.metrics.length,g,m,f,u]);return(0,xe.tZ)(Hr,null,(0,xe.tZ)(gr.Z,We()({},t,{name:"datasource",actions:a})),null!=e.id&&y)}const Kr={...ur.propTypes,height:rt().string,width:rt().string,actions:rt().object.isRequired,datasource_type:rt().string.isRequired,dashboardId:rt().number,isDatasourceMetaLoading:rt().bool.isRequired,chart:ht.$6.isRequired,slice:rt().object,sliceName:rt().string,controls:rt().object.isRequired,forcedHeight:rt().string,form_data:rt().object.isRequired,standalone:rt().number.isRequired,timeout:rt().number,impressionId:rt().string,vizType:rt().string},Gr=Oe.iK.div`
  background: ${({theme:e})=>e.colors.grayscale.light5};
  text-align: left;
  position: relative;
  width: 100%;
  max-height: 100%;
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  flex-basis: 100vh;
  align-items: stretch;
  border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  .explore-column {
    display: flex;
    flex-direction: column;
    padding: ${({theme:e})=>2*e.gridUnit}px 0;
    max-height: 100%;
  }
  .data-source-selection {
    background-color: ${({theme:e})=>e.colors.grayscale.light4};
    padding: ${({theme:e})=>2*e.gridUnit}px 0;
    border-right: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  }
  .main-explore-content {
    flex: 1;
    min-width: ${({theme:e})=>128*e.gridUnit}px;
    border-left: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    .panel {
      margin-bottom: 0;
    }
  }
  .controls-column {
    align-self: flex-start;
    padding: 0;
  }
  .title-container {
    position: relative;
    display: flex;
    flex-direction: row;
    padding: 0 ${({theme:e})=>2*e.gridUnit}px;
    justify-content: space-between;
    .horizontal-text {
      text-transform: uppercase;
      color: ${({theme:e})=>e.colors.grayscale.light1};
      font-size: ${({theme:e})=>4*e.typography.sizes.s};
    }
  }
  .no-show {
    display: none;
  }
  .vertical-text {
    writing-mode: vertical-rl;
    text-orientation: mixed;
  }
  .sidebar {
    height: 100%;
    background-color: ${({theme:e})=>e.colors.grayscale.light4};
    padding: ${({theme:e})=>2*e.gridUnit}px;
    width: ${({theme:e})=>8*e.gridUnit}px;
  }
  .callpase-icon > svg {
    color: ${({theme:e})=>e.colors.primary.base};
  }
`,Jr=()=>({height:window.innerHeight,width:window.innerWidth});function Yr(e){const t=(0,Re.gp)().dynamicPlugins[e.vizType],a=t&&t.mounting,r=(0,st.D)(a),o=(0,st.D)(e.controls),[s,i]=(0,n.useState)(e.controls),c=function({delayMs:e=250}={}){const[t,a]=(0,n.useState)(Jr());return(0,n.useEffect)((()=>{const t=b()((()=>a(Jr())),e);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}),[]),t}(),[l,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(!1),f=(0,Oe.Fg)(),m=`${c.width}px`,g=e.standalone?0:90,v=e.forcedHeight?`${e.forcedHeight}px`:c.height-g+"px",y="controls_width",S="datasource_width",E={controls_width:320,datasource_width:300},Z=(0,n.useCallback)((({isReplace:t=!1,title:a}={})=>{const r=e.dashboardId?{...e.form_data,dashboardId:e.dashboardId}:e.form_data,o={...r},n=(0,w.vp)(r,e.standalone?dt.KD.standalone.name:null,!1);try{t?window.history.replaceState(o,a,n):window.history.pushState(o,a,n)}catch(e){console.warn("Failed at altering browser history",o,a,n)}}),[e.form_data,e.standalone]),C=(0,n.useCallback)((()=>{const t=window.history.state;t&&Object.keys(t).length&&(e.actions.setExploreControls(t),e.actions.postChartFormData(t,!1,e.timeout,e.chart.id))}),[e.actions,e.chart.id,e.timeout]),R=(0,n.useCallback)((()=>{e.actions.triggerQuery(!0,e.chart.id),Z(),i(e.controls)}),[e.controls,Z,e.actions,e.chart.id]),O=(0,n.useCallback)((t=>{if(t.ctrlKey||t.metaKey){const a="Enter"===t.key||13===t.keyCode,r="s"===t.key||83===t.keyCode;a?R():r&&e.slice&&e.actions.saveSlice(e.form_data,{action:"overwrite",slice_id:e.slice.slice_id,slice_name:e.slice.slice_name,add_to_dash:"noSave",goto_dash:!1}).then((({data:e})=>{window.location=e.slice.slice_url}))}}),[R,e.actions,e.form_data,e.slice]);function x(){d(!l)}function N(){h(!u)}it((()=>{e.actions.logEvent(p.$b),Z({isReplace:!0})}));const A=(0,st.D)(C);(0,n.useEffect)((()=>(A&&window.removeEventListener("popstate",A),window.addEventListener("popstate",C),()=>{window.removeEventListener("popstate",C)})),[C,A]);const D=(0,st.D)(O);(0,n.useEffect)((()=>(D&&window.removeEventListener("keydown",D),document.addEventListener("keydown",O),()=>{document.removeEventListener("keydown",O)})),[O,D]),(0,n.useEffect)((()=>{r&&!a&&e.actions.dynamicPluginControlsReady()}),[a]),(0,n.useEffect)((()=>{Object.values(e.controls).some((e=>e.validationErrors&&e.validationErrors.length>0))||e.actions.triggerQuery(!0,e.chart.id)}),[]);const I=()=>{e.actions.updateQueryFormData((0,T.Hu)(e.controls),e.chart.id),e.actions.renderTriggered((new Date).getTime(),e.chart.id),Z()};(0,n.useEffect)((()=>{o&&(!e.controls.datasource||null!=o.datasource&&e.controls.datasource.value===o.datasource.value||(0,ut.QR)(e.form_data.datasource,!0),Object.keys(e.controls).filter((t=>void 0!==o[t]&&!(0,_.JB)(e.controls[t].value,o[t].value))).some((t=>e.controls[t].renderTrigger))&&I())}),[e.controls,e.ownState]);const k=(0,n.useMemo)((()=>!!s&&Object.keys(e.controls).filter((t=>void 0!==s[t]&&!(0,_.JB)(e.controls[t].value,s[t].value))).some((t=>!e.controls[t].renderTrigger&&!e.controls[t].dontRefreshOnChange))),[s,e.controls]);function M(){const t=Object.values(e.controls).filter((e=>e.validationErrors&&e.validationErrors.length>0));if(0===t.length)return null;const a=t.map((e=>e.validationErrors)),r=[...new Set(a.flat())].map((e=>[t.filter((t=>{var a;return null==(a=t.validationErrors)?void 0:a.includes(e)})).map((e=>e.label)),e])).map((([e,t])=>(0,xe.tZ)("div",{key:t},e.length>1?(0,H.t)("Controls labeled "):(0,H.t)("Control labeled "),(0,xe.tZ)("strong",null,` ${e.join(", ")}`),(0,xe.tZ)("span",null,": ",t))));let o;return r.length>0&&(o=(0,xe.tZ)("div",{style:{textAlign:"left"}},r)),o}function j(){return(0,xe.tZ)(ur,We()({width:m,height:v},e,{errorMessage:M(),refreshOverlayVisible:k,addHistory:Z,onQuery:R}))}function U(e){return ct(e,E[e])}function $(e,t){const a=Number(U(e))+t.width;lt(e,a)}return(0,n.useEffect)((()=>{void 0!==e.ownState&&(R(),I())}),[e.ownState]),k&&e.actions.logEvent(p.Ep),e.standalone?j():(0,xe.tZ)(Gr,{id:"explore-container",height:v},(0,xe.tZ)(xe.xB,{styles:xe.iv`
          .navbar {
            margin-bottom: 0;
          }
          body {
            height: 100vh;
            max-height: 100vh;
            overflow: hidden;
          }
          #app-menu,
          #app {
            flex: 1 1 auto;
          }
          #app {
            flex-basis: 100%;
            overflow: hidden;
            height: 100%;
          }
          #app-menu {
            flex-shrink: 0;
          }
        `}),l&&(0,xe.tZ)(Dr,{onHide:x,actions:e.actions,form_data:e.form_data,sliceName:e.sliceName,dashboardId:e.dashboardId}),(0,xe.tZ)(ot.e,{onResizeStop:(e,t,a,r)=>$(S,r),defaultSize:{width:U(S),height:"100%"},minWidth:E.datasource_width,maxWidth:"33%",enable:{right:!0},className:u?"no-show":"explore-column data-source-selection"},(0,xe.tZ)("div",{className:"title-container"},(0,xe.tZ)("span",{className:"horizont al-text"},(0,H.t)("Dataset")),(0,xe.tZ)("span",{role:"button",tabIndex:0,className:"action-button",onClick:N},(0,xe.tZ)(Ie.Z.Expand,{className:"collapse-icon",iconColor:f.colors.primary.base,iconSize:"l"}))),(0,xe.tZ)(Wr,{datasource:e.datasource,controls:e.controls,actions:e.actions})),u?(0,xe.tZ)("div",{className:"sidebar",onClick:N,role:"button",tabIndex:0},(0,xe.tZ)("span",{role:"button",tabIndex:0,className:"action-button"},(0,xe.tZ)(nt.u,{title:(0,H.t)("Open Datasource tab")},(0,xe.tZ)(Ie.Z.Collapse,{className:"collapse-icon",iconColor:f.colors.primary.base,iconSize:"l"}))),(0,xe.tZ)(Ie.Z.DatasetPhysical,{css:(0,xe.iv)({marginTop:2*f.gridUnit},"",""),iconSize:"l",iconColor:f.colors.grayscale.base})):null,(0,xe.tZ)(ot.e,{onResizeStop:(e,t,a,r)=>$(y,r),defaultSize:{width:U(y),height:"100%"},minWidth:E.controls_width,maxWidth:"33%",enable:{right:!0},className:"col-sm-3 explore-column controls-column"},(0,xe.tZ)(Mr,{canAdd:!(!e.can_add&&!e.can_overwrite),onQuery:R,onSave:x,onStop:function(){e.chart&&e.chart.queryController&&e.chart.queryController.abort()},loading:"loading"===e.chart.chartStatus,chartIsStale:k,errorMessage:M(),datasourceType:e.datasource_type}),(0,xe.tZ)(Zr,{actions:e.actions,form_data:e.form_data,controls:e.controls,datasource_type:e.datasource_type,isDatasourceMetaLoading:e.isDatasourceMetaLoading})),(0,xe.tZ)("div",{className:Ae()("main-explore-content",u?"col-sm-9":"col-sm-7")},j()))}Yr.propTypes=Kr;const Xr=(0,Ze.$j)((function(e){var t,a,r,o;const{explore:n,charts:s,impressionId:i,dataMask:c,reports:l}=e,d=(0,T.Hu)(n.controls);d.extra_form_data=(0,ft.on)({...d.extra_form_data},{...null==(t=c[null!=(a=d.slice_id)?a:0])?void 0:t.ownState});const u=s[Object.keys(s)[0]];return{isDatasourceMetaLoading:n.isDatasourceMetaLoading,datasource:n.datasource,datasource_type:n.datasource.type,datasourceId:n.datasource_id,dashboardId:n.form_data?n.form_data.dashboardId:void 0,controls:n.controls,can_overwrite:!!n.can_overwrite,can_add:!!n.can_add,can_download:!!n.can_download,column_formats:n.datasource?n.datasource.column_formats:null,containerId:n.slice?`slice-container-${n.slice.slice_id}`:"slice-container",isStarred:n.isStarred,slice:n.slice,sliceName:n.sliceName,triggerRender:n.triggerRender,form_data:d,table_name:d.datasource_name,vizType:d.viz_type,standalone:n.standalone,forcedHeight:n.forced_height,chart:u,timeout:n.common.conf.SUPERSET_WEBSERVER_TIMEOUT,ownState:null==(r=c[null!=(o=d.slice_id)?o:0])?void 0:r.ownState,impressionId:i,user:n.user,reports:l}}),(function(e){const t={...o,...r,...z,...f};return{actions:(0,i.DE)(t,e)}}))(Yr);Fe()(document).ready((function(){Fe()(":checkbox[data-checkbox-api-prefix]").change((function(){const e=Fe()(this);var t,a;t=e.data("checkbox-api-prefix"),a=`#${e.attr("id")}`,u.Z.get({endpoint:t+Fe()(a)[0].checked}).then((()=>{})).catch((e=>(0,Le.O)(e).then((e=>{e&&e.message&&function(e){const t=e.severity||"info";Fe()('<div class="alert"> <button type="button" class="close" data-dismiss="alert">×</button> </div>').addClass(`alert-${t}`).append(e.message||"").appendTo(Fe()("#alert-container"))}(e)}))))})),Fe()("#language-picker a").click((function(e){e.preventDefault(),u.Z.get({url:e.currentTarget.href,parseMethod:null}).then((()=>{window.location.reload()}))}))})),window.$=Fe(),window.jQuery=Fe(),a(57915),function(){const e=(0,ze.Z)();e.registerValue(Ve.C.FRONTEND_TIMEOUT_ERROR,Qe),e.registerValue(Ve.C.BACKEND_TIMEOUT_ERROR,Qe),e.registerValue(Ve.C.DATABASE_NOT_FOUND_ERROR,Ke),e.registerValue(Ve.C.GENERIC_DB_ENGINE_ERROR,Ke),e.registerValue(Ve.C.GENERIC_BACKEND_ERROR,Ke),e.registerValue(Ve.C.COLUMN_DOES_NOT_EXIST_ERROR,Ke),e.registerValue(Ve.C.TABLE_DOES_NOT_EXIST_ERROR,Ke),e.registerValue(Ve.C.MISSING_TEMPLATE_PARAMS_ERROR,Ye),e.registerValue(Ve.C.INVALID_TEMPLATE_PARAMS_ERROR,Ye),e.registerValue(Ve.C.RESULTS_BACKEND_NOT_CONFIGURED_ERROR,Ke),e.registerValue(Ve.C.DML_NOT_ALLOWED_ERROR,Ke),e.registerValue(Ve.C.INVALID_CTAS_QUERY_ERROR,Ke),e.registerValue(Ve.C.INVALID_CVAS_QUERY_ERROR,Ke),e.registerValue(Ve.C.QUERY_SECURITY_ACCESS_ERROR,Ke),e.registerValue(Ve.C.CONNECTION_INVALID_HOSTNAME_ERROR,Ke),e.registerValue(Ve.C.RESULTS_BACKEND_ERROR,Ke),e.registerValue(Ve.C.ASYNC_WORKERS_ERROR,Ke),e.registerValue(Ve.C.SQLLAB_TIMEOUT_ERROR,Ke),e.registerValue(Ve.C.CONNECTION_PORT_CLOSED_ERROR,Ke),e.registerValue(Ve.C.CONNECTION_HOST_DOWN_ERROR,Ke),e.registerValue(Ve.C.CONNECTION_INVALID_USERNAME_ERROR,Ke),e.registerValue(Ve.C.CONNECTION_INVALID_PASSWORD_ERROR,Ke),e.registerValue(Ve.C.CONNECTION_ACCESS_DENIED_ERROR,Ke),e.registerValue(Ve.C.CONNECTION_UNKNOWN_DATABASE_ERROR,Ke),e.registerValue(Ve.C.SCHEMA_DOES_NOT_EXIST_ERROR,Ke),e.registerValue(Ve.C.OBJECT_DOES_NOT_EXIST_ERROR,Ke),e.registerValue(Ve.C.SYNTAX_ERROR,Ke),e.registerValue(Ve.C.CONNECTION_DATABASE_PERMISSIONS_ERROR,Ke),e.registerValue(Ve.C.FAILED_FETCHING_DATASOURCE_INFO_ERROR,Xe)}(),(0,et.Z)();const eo=document.getElementById("app"),to=JSON.parse(eo.getAttribute("data-bootstrap"));(0,y.fG)(to.common.feature_flags);const ao=function(e){const{form_data:t}=e,{slice:a}=e,r=a?a.slice_name:null,o={...e,sliceName:r,common:{flash_messages:e.common.flash_messages,conf:e.common.conf},isDatasourceMetaLoading:!1,isStarred:!1,controls:(0,C.R3)(e,t)};Object.entries(o.controls).forEach((([e,t])=>{o.controls[e]=(0,T.RO)(t,o)}));const n=a?(0,T.Hu)((0,C.R3)(e,a.form_data)):null,s=(0,w.Jp)(e);return{charts:{[s]:{id:s,chartAlert:null,chartStatus:null,chartStackTrace:null,chartUpdateEndTime:null,chartUpdateStartTime:0,latestQueryFormData:(0,T.Hu)(o.controls),sliceFormData:n,queryController:null,queriesResponse:null,triggerQuery:!1,lastRendered:0}},saveModal:{dashboards:[],saveModalAlert:null},explore:o,impressionId:d().generate(),messageToasts:Z((e.common||{}).flash_messages||[])}}(to),ro=(0,i.MT)(Ee,ao,(0,i.qC)((0,i.md)(c.Z,(e=>t=>a=>{var r;if(a.type!==f.LOG_EVENT)return t(a);const{dashboardInfo:o,explore:n,impressionId:s,dashboardLayout:i}=e.getState();let c={impression_id:s,version:"v2"};o?c={source:"dashboard",source_id:o.id,...c}:n&&(c={source:"explore",source_id:n.slice?n.slice.slice_id:0,...c});const{eventName:l}=a.payload;let{eventData:u={}}=a.payload;if(u={...c,ts:(new Date).getTime(),event_name:l,...u},p.TY.has(l)?u={...u,event_type:"timing",trigger_event:v}:(v=d().generate(),u={...u,event_type:"user",event_id:v,visibility:document.visibilityState}),u.target_id&&null!=i&&null!=(r=i.present)&&r[u.target_id]){const{meta:e}=i.present[u.target_id];u.target_name=e.chartId?e.sliceName:e.text}return g.append(u),u})),(0,_.hU)(!1)));s.render((0,xe.tZ)((({store:e})=>(0,xe.tZ)(Ze.zt,{store:e},(0,xe.tZ)(we.W,{backend:Ce.PD},(0,xe.tZ)(Te.a,{theme:tt.r},(0,xe.tZ)(Re.EM,null,(0,xe.tZ)(Xr,null),(0,xe.tZ)($e,null)))))),{store:ro}),document.getElementById("app"))},61358:(e,t,a)=>{"use strict";a.d(t,{jt:()=>l,Aw:()=>d,J8:()=>h,cq:()=>f,Dr:()=>p,Me:()=>m,M:()=>b,MZ:()=>g});var r=a(31069),o=a(61988),n=a(15926),s=a.n(n),i=a(98286),c=a(72570);const l="SET_REPORT";function d(e,t,a,n){const i=s().encode({filters:[{col:t,opr:"eq",value:n},{col:"creation_method",opr:"eq",value:a},{col:"created_by",opr:"rel_o_m",value:e}]});return function(e){return r.Z.get({endpoint:`/api/v1/report/?q=${i}`}).then((({json:t})=>{e({type:l,report:t})})).catch((()=>e((0,c.Gb)((0,o.t)("There was an issue fetching reports attached to this dashboard.")))))}}const u=(e,t)=>{const a=t(),{user:r,dashboardInfo:o,charts:n,explore:s}=a;if(o)e(d(r.userId,"dashboard_id","dashboards",o.id));else{const[t]=Object.keys(n);e(d(s.user.userId,"chart_id","charts",n[t].id))}},h="ADD_REPORT",f=e=>t=>r.Z.post({endpoint:"/api/v1/report/",jsonPayload:e}).then((({json:e})=>{t({type:h,json:e}),t((0,c.ws)((0,o.t)("The report has been created")))})).catch((async e=>{const a=(await(0,i.O)(e)).message,r=a[Object.keys(a)[0]];t((0,c.Gb)((0,o.t)("An error occurred while editing this report: %s",r)))})),p="EDIT_REPORT";function m(e,t){return function(a){r.Z.put({endpoint:`/api/v1/report/${e}`,jsonPayload:t}).then((({json:e})=>{a({type:p,json:e})})).catch((()=>a((0,c.Gb)((0,o.t)("An error occurred while editing this report.")))))}}function b(e,t){return function(a){return r.Z.put({endpoint:encodeURI(`/api/v1/report/${e.id}`),headers:{"Content-Type":"application/json"},body:JSON.stringify({active:t})}).catch((()=>{a((0,c.Gb)((0,o.t)("We were unable to active or deactivate this report.")))})).finally((()=>{a(u)}))}}function g(e){return function(t){return r.Z.delete({endpoint:encodeURI(`/api/v1/report/${e.id}`)}).catch((()=>{t((0,c.Gb)((0,o.t)("Your report could not be deleted")))})).finally((()=>{t(u),t((0,c.ws)((0,o.t)("Deleted: %s",e.name)))}))}}},91296:(e,t,a)=>{var r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,s=/^0o[0-7]+$/i,i=parseInt,c="object"==typeof a.g&&a.g&&a.g.Object===Object&&a.g,l="object"==typeof self&&self&&self.Object===Object&&self,d=c||l||Function("return this")(),u=Object.prototype.toString,h=Math.max,f=Math.min,p=function(){return d.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var a=n.test(e);return a||s.test(e)?i(e.slice(2),a?2:8):o.test(e)?NaN:+e}e.exports=function(e,t,a){var r,o,n,s,i,c,l=0,d=!1,u=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var a=r,n=o;return r=o=void 0,l=t,s=e.apply(n,a)}function y(e){return l=e,i=setTimeout(S,t),d?v(e):s}function _(e){var a=e-c;return void 0===c||a>=t||a<0||u&&e-l>=n}function S(){var e=p();if(_(e))return E(e);i=setTimeout(S,function(e){var a=t-(e-c);return u?f(a,n-(e-l)):a}(e))}function E(e){return i=void 0,g&&r?v(e):(r=o=void 0,s)}function Z(){var e=p(),a=_(e);if(r=arguments,o=this,c=e,a){if(void 0===i)return y(c);if(u)return i=setTimeout(S,t),v(c)}return void 0===i&&(i=setTimeout(S,t)),s}return t=b(t)||0,m(a)&&(d=!!a.leading,n=(u="maxWait"in a)?h(b(a.maxWait)||0,t):n,g="trailing"in a?!!a.trailing:g),Z.cancel=function(){void 0!==i&&clearTimeout(i),l=0,r=c=o=i=void 0},Z.flush=function(){return void 0===i?s:E(p())},Z}},93096:(e,t,a)=>{var r="Expected a function",o=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,i=/^0o[0-7]+$/i,c=parseInt,l="object"==typeof a.g&&a.g&&a.g.Object===Object&&a.g,d="object"==typeof self&&self&&self.Object===Object&&self,u=l||d||Function("return this")(),h=Object.prototype.toString,f=Math.max,p=Math.min,m=function(){return u.Date.now()};function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==h.call(e)}(e))return NaN;if(b(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=b(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var a=s.test(e);return a||i.test(e)?c(e.slice(2),a?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,a){var o=!0,n=!0;if("function"!=typeof e)throw new TypeError(r);return b(a)&&(o="leading"in a?!!a.leading:o,n="trailing"in a?!!a.trailing:n),function(e,t,a){var o,n,s,i,c,l,d=0,u=!1,h=!1,v=!0;if("function"!=typeof e)throw new TypeError(r);function y(t){var a=o,r=n;return o=n=void 0,d=t,i=e.apply(r,a)}function _(e){return d=e,c=setTimeout(E,t),u?y(e):i}function S(e){var a=e-l;return void 0===l||a>=t||a<0||h&&e-d>=s}function E(){var e=m();if(S(e))return Z(e);c=setTimeout(E,function(e){var a=t-(e-l);return h?p(a,s-(e-d)):a}(e))}function Z(e){return c=void 0,v&&o?y(e):(o=n=void 0,i)}function w(){var e=m(),a=S(e);if(o=arguments,n=this,l=e,a){if(void 0===c)return _(l);if(h)return c=setTimeout(E,t),y(l)}return void 0===c&&(c=setTimeout(E,t)),i}return t=g(t)||0,b(a)&&(u=!!a.leading,s=(h="maxWait"in a)?f(g(a.maxWait)||0,t):s,v="trailing"in a?!!a.trailing:v),w.cancel=function(){void 0!==c&&clearTimeout(c),d=0,o=l=n=c=void 0},w.flush=function(){return void 0===c?i:Z(m())},w}(e,t,{leading:o,maxWait:t,trailing:n})}},90233:(e,t,a)=>{"use strict";a.d(t,{Lu:()=>c,tL:()=>s});var r=a(87462),o=a(76826),n=a.n(o),s={CASE_SENSITIVE_EQUAL:7,EQUAL:6,STARTS_WITH:5,WORD_STARTS_WITH:4,CONTAINS:3,ACRONYM:2,MATCHES:1,NO_MATCH:0};c.rankings=s;var i=function(e,t){return String(e.rankedValue).localeCompare(String(t.rankedValue))};function c(e,t,a){void 0===a&&(a={});var o=a,n=o.keys,c=o.threshold,d=void 0===c?s.MATCHES:c,h=o.baseSort,p=void 0===h?i:h,m=o.sorter,b=void 0===m?function(e){return e.sort((function(e,t){return function(e,t,a){var r=e.rank,o=e.keyIndex,n=t.rank,s=t.keyIndex;return r===n?o===s?a(e,t):o<s?-1:1:r>n?-1:1}(e,t,p)}))}:m,g=e.reduce((function(e,o,i){var c=function(e,t,a,r){return t?function(e,t){for(var a=[],r=0,o=t.length;r<o;r++)for(var n=t[r],s=f(n),i=u(e,n),c=0,l=i.length;c<l;c++)a.push({itemValue:i[c],attributes:s});return a}(e,t).reduce((function(e,t,o){var n=e.rank,i=e.rankedValue,c=e.keyIndex,d=e.keyThreshold,u=t.itemValue,h=t.attributes,f=l(u,a,r),p=i,m=h.minRanking,b=h.maxRanking,g=h.threshold;return f<m&&f>=s.MATCHES?f=m:f>b&&(f=b),f>n&&(n=f,c=o,d=g,p=u),{rankedValue:p,rank:n,keyIndex:c,keyThreshold:d}}),{rankedValue:e,rank:s.NO_MATCH,keyIndex:-1,keyThreshold:r.threshold}):{rankedValue:e,rank:l(e,a,r),keyIndex:-1,keyThreshold:r.threshold}}(o,n,t,a),h=c.rank,p=c.keyThreshold;return h>=(void 0===p?d:p)&&e.push((0,r.Z)({},c,{item:o,index:i})),e}),[]);return b(g).map((function(e){return e.item}))}function l(e,t,a){return e=d(e,a),(t=d(t,a)).length>e.length?s.NO_MATCH:e===t?s.CASE_SENSITIVE_EQUAL:(e=e.toLowerCase())===(t=t.toLowerCase())?s.EQUAL:e.startsWith(t)?s.STARTS_WITH:e.includes(" "+t)?s.WORD_STARTS_WITH:e.includes(t)?s.CONTAINS:1===t.length?s.NO_MATCH:(r=e,o="",r.split(" ").forEach((function(e){e.split("-").forEach((function(e){o+=e.substr(0,1)}))})),o).includes(t)?s.ACRONYM:function(e,t){var a=0,r=0;function o(e,t,r){for(var o=r,n=t.length;o<n;o++)if(t[o]===e)return a+=1,o+1;return-1}var n,i,c=o(t[0],e,0);if(c<0)return s.NO_MATCH;r=c;for(var l=1,d=t.length;l<d;l++)if(!((r=o(t[l],e,r))>-1))return s.NO_MATCH;return n=1/(r-c),i=a/t.length,s.MATCHES+i*n}(e,t);var r,o}function d(e,t){return e=""+e,t.keepDiacritics||(e=n()(e)),e}function u(e,t){var a;if("object"==typeof t&&(t=t.key),"function"==typeof t)a=t(e);else if(null==e)a=null;else if(Object.hasOwnProperty.call(e,t))a=e[t];else{if(t.includes("."))return function(e,t){for(var a=e.split("."),r=[t],o=0,n=a.length;o<n;o++){for(var s=a[o],i=[],c=0,l=r.length;c<l;c++){var d=r[c];if(null!=d)if(Object.hasOwnProperty.call(d,s)){var u=d[s];null!=u&&i.push(u)}else"*"===s&&(i=i.concat(d))}r=i}if(Array.isArray(r[0])){var h=[];return h.concat.apply(h,r)}return r}(t,e);a=null}return null==a?[]:Array.isArray(a)?a:[String(a)]}var h={maxRanking:1/0,minRanking:-1/0};function f(e){return"string"==typeof e?h:(0,r.Z)({},h,e)}},76826:e=>{var t={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Ấ:"A",Ắ:"A",Ẳ:"A",Ẵ:"A",Ặ:"A",Æ:"AE",Ầ:"A",Ằ:"A",Ȃ:"A",Ç:"C",Ḉ:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ế:"E",Ḗ:"E",Ề:"E",Ḕ:"E",Ḝ:"E",Ȇ:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ḯ:"I",Ȋ:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",Ố:"O",Ṍ:"O",Ṓ:"O",Ȏ:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ý:"Y",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",ấ:"a",ắ:"a",ẳ:"a",ẵ:"a",ặ:"a",æ:"ae",ầ:"a",ằ:"a",ȃ:"a",ç:"c",ḉ:"c",è:"e",é:"e",ê:"e",ë:"e",ế:"e",ḗ:"e",ề:"e",ḕ:"e",ḝ:"e",ȇ:"e",ì:"i",í:"i",î:"i",ï:"i",ḯ:"i",ȋ:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",ố:"o",ṍ:"o",ṓ:"o",ȏ:"o",ù:"u",ú:"u",û:"u",ü:"u",ý:"y",ÿ:"y",Ā:"A",ā:"a",Ă:"A",ă:"a",Ą:"A",ą:"a",Ć:"C",ć:"c",Ĉ:"C",ĉ:"c",Ċ:"C",ċ:"c",Č:"C",č:"c",C̆:"C",c̆:"c",Ď:"D",ď:"d",Đ:"D",đ:"d",Ē:"E",ē:"e",Ĕ:"E",ĕ:"e",Ė:"E",ė:"e",Ę:"E",ę:"e",Ě:"E",ě:"e",Ĝ:"G",Ǵ:"G",ĝ:"g",ǵ:"g",Ğ:"G",ğ:"g",Ġ:"G",ġ:"g",Ģ:"G",ģ:"g",Ĥ:"H",ĥ:"h",Ħ:"H",ħ:"h",Ḫ:"H",ḫ:"h",Ĩ:"I",ĩ:"i",Ī:"I",ī:"i",Ĭ:"I",ĭ:"i",Į:"I",į:"i",İ:"I",ı:"i",Ĳ:"IJ",ĳ:"ij",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",Ḱ:"K",ḱ:"k",K̆:"K",k̆:"k",Ĺ:"L",ĺ:"l",Ļ:"L",ļ:"l",Ľ:"L",ľ:"l",Ŀ:"L",ŀ:"l",Ł:"l",ł:"l",Ḿ:"M",ḿ:"m",M̆:"M",m̆:"m",Ń:"N",ń:"n",Ņ:"N",ņ:"n",Ň:"N",ň:"n",ŉ:"n",N̆:"N",n̆:"n",Ō:"O",ō:"o",Ŏ:"O",ŏ:"o",Ő:"O",ő:"o",Œ:"OE",œ:"oe",P̆:"P",p̆:"p",Ŕ:"R",ŕ:"r",Ŗ:"R",ŗ:"r",Ř:"R",ř:"r",R̆:"R",r̆:"r",Ȓ:"R",ȓ:"r",Ś:"S",ś:"s",Ŝ:"S",ŝ:"s",Ş:"S",Ș:"S",ș:"s",ş:"s",Š:"S",š:"s",Ţ:"T",ţ:"t",ț:"t",Ț:"T",Ť:"T",ť:"t",Ŧ:"T",ŧ:"t",T̆:"T",t̆:"t",Ũ:"U",ũ:"u",Ū:"U",ū:"u",Ŭ:"U",ŭ:"u",Ů:"U",ů:"u",Ű:"U",ű:"u",Ų:"U",ų:"u",Ȗ:"U",ȗ:"u",V̆:"V",v̆:"v",Ŵ:"W",ŵ:"w",Ẃ:"W",ẃ:"w",X̆:"X",x̆:"x",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Y̆:"Y",y̆:"y",Ź:"Z",ź:"z",Ż:"Z",ż:"z",Ž:"Z",ž:"z",ſ:"s",ƒ:"f",Ơ:"O",ơ:"o",Ư:"U",ư:"u",Ǎ:"A",ǎ:"a",Ǐ:"I",ǐ:"i",Ǒ:"O",ǒ:"o",Ǔ:"U",ǔ:"u",Ǖ:"U",ǖ:"u",Ǘ:"U",ǘ:"u",Ǚ:"U",ǚ:"u",Ǜ:"U",ǜ:"u",Ứ:"U",ứ:"u",Ṹ:"U",ṹ:"u",Ǻ:"A",ǻ:"a",Ǽ:"AE",ǽ:"ae",Ǿ:"O",ǿ:"o",Þ:"TH",þ:"th",Ṕ:"P",ṕ:"p",Ṥ:"S",ṥ:"s",X́:"X",x́:"x",Ѓ:"Г",ѓ:"г",Ќ:"К",ќ:"к",A̋:"A",a̋:"a",E̋:"E",e̋:"e",I̋:"I",i̋:"i",Ǹ:"N",ǹ:"n",Ồ:"O",ồ:"o",Ṑ:"O",ṑ:"o",Ừ:"U",ừ:"u",Ẁ:"W",ẁ:"w",Ỳ:"Y",ỳ:"y",Ȁ:"A",ȁ:"a",Ȅ:"E",ȅ:"e",Ȉ:"I",ȉ:"i",Ȍ:"O",ȍ:"o",Ȑ:"R",ȑ:"r",Ȕ:"U",ȕ:"u",B̌:"B",b̌:"b",Č̣:"C",č̣:"c",Ê̌:"E",ê̌:"e",F̌:"F",f̌:"f",Ǧ:"G",ǧ:"g",Ȟ:"H",ȟ:"h",J̌:"J",ǰ:"j",Ǩ:"K",ǩ:"k",M̌:"M",m̌:"m",P̌:"P",p̌:"p",Q̌:"Q",q̌:"q",Ř̩:"R",ř̩:"r",Ṧ:"S",ṧ:"s",V̌:"V",v̌:"v",W̌:"W",w̌:"w",X̌:"X",x̌:"x",Y̌:"Y",y̌:"y",A̧:"A",a̧:"a",B̧:"B",b̧:"b",Ḑ:"D",ḑ:"d",Ȩ:"E",ȩ:"e",Ɛ̧:"E",ɛ̧:"e",Ḩ:"H",ḩ:"h",I̧:"I",i̧:"i",Ɨ̧:"I",ɨ̧:"i",M̧:"M",m̧:"m",O̧:"O",o̧:"o",Q̧:"Q",q̧:"q",U̧:"U",u̧:"u",X̧:"X",x̧:"x",Z̧:"Z",z̧:"z"},a=Object.keys(t).join("|"),r=new RegExp(a,"g"),o=new RegExp(a,""),n=function(e){return e.replace(r,(function(e){return t[e]}))};e.exports=n,e.exports.has=function(e){return!!e.match(o)},e.exports.remove=n},29432:(e,t,a)=>{"use strict";a.d(t,{hb:()=>f,QU:()=>p,Es:()=>m,JL:()=>b});var r,o=a(22102),n=a(67294);!function(e){e.LOADING="loading",e.COMPLETE="complete",e.ERROR="error"}(r||(r={}));const s={status:r.LOADING,result:null,error:null};function i(e,t){return(0,n.useMemo)((()=>{if(e.status!==r.COMPLETE)return e;try{return{...e,result:t(e.result)}}catch(e){return{status:r.ERROR,result:null,error:e}}}),[e,t])}const c=e=>e.result;function l(e){return i(function(e){const[t,a]=(0,n.useState)(s),i=(0,n.useRef)((()=>{}));return(0,n.useEffect)((()=>{a(s),i.current();let t=!1;return i.current=()=>{t=!0},(0,o.Z)({method:"GET",endpoint:e})({}).then((e=>{t||a({status:r.COMPLETE,result:e,error:null})})).catch((e=>{t||a({status:r.ERROR,result:null,error:e})})),()=>{t=!0}}),[e]),t}(e),c)}var d=a(15926);function u({owners:e}){return e?e.map((e=>`${e.first_name} ${e.last_name}`)):null}const h=a.n(d)().encode({columns:["owners.first_name","owners.last_name"],keys:["none"]});function f(e){return i(l(`/api/v1/chart/${e}?q=${h}`),u)}const p=e=>i(l(`/api/v1/dashboard/${e}`),(e=>({...e,metadata:e.json_metadata&&JSON.parse(e.json_metadata)||{},position_data:e.position_json&&JSON.parse(e.position_json)}))),m=e=>l(`/api/v1/dashboard/${e}/charts`),b=e=>l(`/api/v1/dashboard/${e}/datasets`)},83268:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var r=a(67294),o=a(61988),n=a(51995),s=a(38097),i=a(58593),c=a(11965);const l=function({certifiedBy:e,details:t,size:a="l"}){return(0,c.tZ)(i.u,{id:"certified-details-tooltip",title:(0,c.tZ)(r.Fragment,null,e&&(0,c.tZ)("div",null,(0,c.tZ)("strong",null,(0,o.t)("Certified by %s",e))),(0,c.tZ)("div",null,t))},(0,c.tZ)(s.Z.Certified,{iconColor:n.K6.colors.primary.base,iconSize:a}))}},17198:(e,t,a)=>{"use strict";a.d(t,{Z:()=>h});var r=a(51995),o=a(61988),n=a(67294),s=a(82191),i=a(74069),c=a(49238),l=a(11965);const d=r.iK.div`
  padding-top: 8px;
  width: 50%;
  label {
    color: ${({theme:e})=>e.colors.grayscale.light1};
    text-transform: uppercase;
  }
`,u=r.iK.div`
  line-height: 40px;
  padding-top: 16px;
`;function h({description:e,onConfirm:t,onHide:a,open:r,title:h}){const[f,p]=(0,n.useState)(!0),[m,b]=(0,n.useState)(""),g=()=>{b(""),t()};return(0,l.tZ)(i.Z,{disablePrimaryButton:f,onHide:()=>{b(""),a()},onHandledPrimaryAction:g,primaryButtonName:(0,o.t)("delete"),primaryButtonType:"danger",show:r,title:h},(0,l.tZ)(u,null,e),(0,l.tZ)(d,null,(0,l.tZ)(c.lX,{htmlFor:"delete"},(0,o.t)('Type "%s" to confirm',(0,o.t)("DELETE"))),(0,l.tZ)(s.II,{type:"text",id:"delete",autoComplete:"off",value:m,onChange:e=>{var t;const a=null!=(t=e.target.value)?t:"";p(a.toUpperCase()!==(0,o.t)("DELETE")),b(a)},onPressEnter:()=>{f||g()}})))}}},c={};function l(e){var t=c[e];if(void 0!==t)return t.exports;var a=c[e]={id:e,loaded:!1,exports:{}};return i[e].call(a.exports,a,a.exports,l),a.loaded=!0,a.exports}l.m=i,l.amdD=function(){throw new Error("define cannot be used indirect")},l.amdO={},e=[],l.O=(t,a,r,o)=>{if(!a){var n=1/0;for(d=0;d<e.length;d++){for(var[a,r,o]=e[d],s=!0,i=0;i<a.length;i++)(!1&o||n>=o)&&Object.keys(l.O).every((e=>l.O[e](a[i])))?a.splice(i--,1):(s=!1,o<n&&(n=o));if(s){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[a,r,o]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var o=Object.create(null);l.r(o);var n={};t=t||[null,a({}),a([]),a(a)];for(var s=2&r&&e;"object"==typeof s&&!~t.indexOf(s);s=a(s))Object.getOwnPropertyNames(s).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,l.d(o,n),o},l.d=(e,t)=>{for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((t,a)=>(l.f[a](e,t),t)),[])),l.u=e=>2441===e?"2441.cf2d2dd99eca21c7005d.entry.js":{3:"e044f7b0a449682b2a0f",57:"3eef258f00447ab2ba56",71:"64dff638ddc03dfb750e",112:"881dd2510f19ed31e172",158:"488593bc94ab7caa58e0",177:"4b03c272091be7836683",183:"3f0101a74920ebdf5721",215:"abe0f2a4a3f69594f00c",310:"77d6d4c65a4250a67f54",312:"ba5d653bdbc1bcc11798",326:"13befc7c02e971fa27e6",336:"f4bdd4f606d6d7592f7e",347:"5c3072822b5d502ad29e",349:"31b11e55a94ab02f4dfe",363:"210381fc4c2bbae6d099",440:"515662946aea2cdc4413",487:"40503a6950dbf2157faa",597:"20b87c137727ff9aaf87",600:"044558ce92babe1fa2db",616:"46a3ab40d9d608278bac",666:"7528cb224ba4e8ab7ff0",704:"605e862d0b9277b5841c",775:"0cafbcf779bf55db0f5e",826:"0e2f19bbb57b5a8aff83",948:"ea0bebd2acbe917ebac3",992:"d71578d87db841083c93",999:"ce189cf323818358d600",1020:"64b7861f73207926d44a",1075:"2572ea51a4adfc4ff9a4",1095:"23f0030f6dc8b7ad0d18",1130:"46ccee8108491632f0d8",1174:"1033573182d374214540",1185:"63e33afadbeb6e51d8dd",1256:"035f322d4ce964f73de1",1258:"6381160c0229525565fd",1263:"cfe95e8e20298feb874e",1293:"14b3a7ee4cc17de5c441",1351:"2eb1a9ba1648eb7a8193",1391:"a8a93d823d39dcebc6e6",1398:"0c371615e0996614785c",1484:"ccb78007257fa70cd036",1493:"0c0664678b66d74ba38f",1568:"b2bb81324e29ed5bce61",1573:"c3be8c690992b983b688",1605:"d6a140bf5e3bef201212",1877:"52fab7b4dc4377dfa77e",1899:"e1eb313fc03e90fa0d70",1921:"0021e070e1ad27c8f7c7",1948:"be3b3d7d44afbcd49863",2079:"579cd7268aa39862c290",2089:"13db7039a066b543f45a",2101:"b7b704a50c891a94eda3",2105:"02df5ff9f97c181f9de4",2112:"1d1b4aaac5752d48445e",2264:"5a90b87bf6c82cddd60f",2267:"58a5465f711b4c6b0f0c",2403:"ff967bce10197be4d6e0",2439:"92ff10820007284a3594",2508:"c967214c45a6bf6f134b",2646:"3dcaf7b2edc6b26550ba",2651:"d20e609d909dc3849e50",2698:"e7b7a6eeb3966de7d0c1",2713:"a68c27cd1e12e64ffed4",2797:"5db241c8af5a71f0f30d",2862:"ac3a161f93f1783b8e1c",2983:"8afbd45ac5fc6d8b4b6d",3037:"4724ca19cf8bbd40ab1f",3141:"494a0ca0a1bb39f625bd",3208:"2afd52e561441bd5beb3",3240:"e7218edd46dedf7e1dda",3265:"1671e36958a7bf6f4cfc",3325:"9295baeedc623870f610",3496:"8b676dbc1ce1115584e9",3544:"0fb4e4d961165cd76e18",3558:"e2f6e711a397fa768c21",3567:"d77d0432d12254aeeded",3606:"0b65905a659b39cd6909",3711:"a1b62cfd4d731b64de89",3749:"9d45482bb7e08b4be181",3776:"dab8fb32eee2f963fb2c",3871:"b94982d813b3a1874fe0",3955:"afc2c2846692569a5718",3985:"f293395f2172b1317b51",4022:"28d8440da84fb8342b9c",4139:"285945130a72bfc46e1d",4192:"2849abf0f62e6178c37d",4194:"6979cd71c8f9a8e1a641",4266:"5b30930400b0988390e0",4273:"7ddbd55189a7899df93c",4458:"4309988c3c4fa37de107",4474:"b598fc6c061ecd9e6b0d",4486:"6bb111b5e24e540e2b48",4572:"90930cfba3ca7682bbdb",4579:"16ca3c26d224ec2bea51",4625:"51252df40a568e9858e9",4640:"4527aeb9ad32d0ce0a42",4662:"b32dd6447e5fae270c83",4667:"48c3843ffce6d71edad4",4732:"40416b4ab4e61de326ae",4757:"93d740911bd493adf140",4758:"139bfe0e5a3d55b967f5",4790:"8c6e41a2f70962281990",4794:"604a01412367c61f28d1",4797:"ec310aed295dd6ac6d3e",4810:"c9e88f8bb26309aea9a3",4817:"c6d5f79ba80cd01dc865",4832:"ef14aea5648058059b49",4851:"ddfa921c0ae9aa3cc18b",4972:"c5b4433dc989f0536983",4981:"a591e398113e3a68af10",5019:"d90df390308d02c8710f",5094:"c9412a6176ec7c209df3",5138:"f10c07a0d5e0d765cb0c",5181:"337c70d9dfcba34d464b",5201:"3ec18a3a291224aa9108",5215:"d96d8f48f1ace1189109",5224:"c47e9d538010833596c1",5226:"6827078f00442327de34",5249:"666b274dce41432ba44f",5253:"4d73af5d529519600793",5264:"f8c22524eb5b1a3bb90c",5281:"bee09c165592668d3f89",5322:"994cc50e1f4dc0a8ee7e",5330:"599272faeb108b72e7f9",5335:"8aa0878ebf5d4ad6ce59",5350:"074a558227a6662abcb5",5359:"2b8c50de5d5c4b38aca0",5367:"21ae5e3e001039f857b3",5428:"5462d035f62f68d46e6d",5507:"f70d497b4e7632b6cc22",5580:"24915749e40e9d761a9c",5592:"e87311d9b096af643f33",5641:"38809faee0024a508b21",5662:"4c63a01bb3c14306206c",5707:"147d8ca4332836cd578d",5714:"c0a5598bd11919f5de34",5771:"1052f585ff4ae106bee8",5777:"554d568382eb31588d65",5802:"6cc12bb8302843f1d8f2",5816:"280673beea0b5f2fd1e1",5832:"0c735281dd62de64b370",5838:"dbba442e12c14d0a2a2e",5962:"72dc9794359fb77a60d2",5965:"7ba10c436338d6178bc3",5972:"19c7fc52abf01d211d54",5998:"1ee3b4651923335492d5",6061:"55bf4311a87981b3e733",6126:"91fa0738674c868ec8cc",6150:"dc68c567fc3c38729c6e",6167:"d6258818427262c45fa8",6207:"6910f3c4f0be2cfcd7f9",6254:"fb638befd53ef04822fc",6303:"ad52f9efd303183abf5e",6371:"83c9e45ceb3fbb5ac155",6420:"c893ff2534f9ec304fc8",6447:"ae65f54f868cf08677c1",6507:"45af87d3e964f08e8a6b",6618:"ba6c036253abfd3a1536",6668:"55647a5d1bc9e3c671d6",6682:"9becee958a13c31f4d51",6693:"f1cdf0df26961fd723e2",6758:"6fcf8c53e0a66334e5b5",6819:"e5d97b6c04bdd4635620",6883:"520bd0ef8bbe299a89fd",6977:"d2b3c9ce6ad0030f20e0",6981:"a398d4d79a48e5730885",7040:"a567f79ae23d4afa0986",7183:"5a6c8f84f8386ea3c3ed",7249:"4073992e83966234ebec",7405:"108895750399ba59f40d",7460:"6a739700fefd3a4fbac2",7521:"b3e48e3afdb9d7bd6105",7584:"f1a7f6c3be667fceb4de",7610:"fe88065240ff7a6e5504",7654:"1cc0055d2d390c30d171",7670:"1dc70845e2c10cae69b6",7716:"26ccebd94ddb1fb178f8",7760:"df6139586bc8db9f4686",7803:"fa5606e48db6b49a7a94",7832:"741031b8b31f62237cd5",7850:"daed96c9f6d33ebc1f7c",7893:"4651b213a499300c10f9",7922:"5d8ea477355f17a5b790",7984:"b82375035a5085f4c589",8230:"f279231505e210422d1f",8296:"59920afb3c403fc17114",8312:"65a7d4d9a4760d7a5210",8349:"7aa90fbe18ad73a1b95a",8371:"b7afb491642f0513814c",8398:"602f4d50559d187c1db8",8425:"d4ab2b8d82b74d62566e",8463:"44ea1565bba7d3f2c8f7",8464:"fe278f2ec62ae054e8d3",8616:"dee76665d36ed3374636",8650:"b38c26f434cc76a0d485",8682:"689daa7df9dd2c6fa4fd",8695:"01d9bc6edddbf539b1b7",8701:"dc881152d46536521640",8750:"dc92e0e945b83ec1e05f",8883:"a09378804d20733f3763",8924:"9bbf28b219c42e28b943",8970:"cc02d84919fe9ecd9cde",9013:"a4b833b1258c7c9a94fd",9052:"02f43b9abb68bfc5f39c",9109:"276f36aed8996da1df63",9131:"7262db8c6f956b6cf9b3",9164:"66b15aa41acbbf80bfaf",9305:"34d5c67b5c79995f8a60",9325:"1defe50332e08632f07f",9364:"71eddbe7fd3d2c4da13c",9387:"45931ad95f004cb5648e",9393:"442f478da05ba19070c4",9483:"003880b76e42f0c363e6",9510:"c5c3e89e58541aa7825b",9558:"d2eaa19757d176a93ab7",9629:"9d09a4ae7f580a31666d",9767:"ad438ca70361b5e69126",9794:"c13a738c3f6b2ba76ca9",9811:"21a7c18f6923c4c737b9",9857:"6a190c6f42d0d89b5004"}[e]+".chunk.js",l.miniCssF=e=>e+"."+{3:"e044f7b0a449682b2a0f",1391:"a8a93d823d39dcebc6e6",1484:"ccb78007257fa70cd036",1877:"52fab7b4dc4377dfa77e",1921:"0021e070e1ad27c8f7c7",2101:"b7b704a50c891a94eda3",2508:"c967214c45a6bf6f134b",2651:"d20e609d909dc3849e50",2862:"ac3a161f93f1783b8e1c",3776:"dab8fb32eee2f963fb2c",4192:"2849abf0f62e6178c37d",4194:"6979cd71c8f9a8e1a641",4640:"4527aeb9ad32d0ce0a42",5138:"f10c07a0d5e0d765cb0c",5253:"4d73af5d529519600793",5322:"994cc50e1f4dc0a8ee7e",5428:"5462d035f62f68d46e6d",5662:"4c63a01bb3c14306206c",5714:"c0a5598bd11919f5de34",5965:"7ba10c436338d6178bc3",6618:"ba6c036253abfd3a1536",7040:"a567f79ae23d4afa0986",7893:"4651b213a499300c10f9",8296:"59920afb3c403fc17114",8650:"b38c26f434cc76a0d485",9164:"66b15aa41acbbf80bfaf",9364:"71eddbe7fd3d2c4da13c",9387:"45931ad95f004cb5648e"}[e]+".chunk.css",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},o="superset:",l.l=(e,t,a,n)=>{if(r[e])r[e].push(t);else{var s,i;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==o+a){s=u;break}}s||(i=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,l.nc&&s.setAttribute("nonce",l.nc),s.setAttribute("data-webpack",o+a),s.src=e),r[e]=[t];var h=(t,a)=>{s.onerror=s.onload=null,clearTimeout(f);var o=r[e];if(delete r[e],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(a))),t)return t(a)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),i&&document.head.appendChild(s)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),l.p="/static/assets/",n=e=>new Promise(((t,a)=>{var r=l.miniCssF(e),o=l.p+r;if(((e,t)=>{for(var a=document.getElementsByTagName("link"),r=0;r<a.length;r++){var o=(s=a[r]).getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(o===e||o===t))return s}var n=document.getElementsByTagName("style");for(r=0;r<n.length;r++){var s;if((o=(s=n[r]).getAttribute("data-href"))===e||o===t)return s}})(r,o))return t();((e,t,a,r)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.onerror=o.onload=n=>{if(o.onerror=o.onload=null,"load"===n.type)a();else{var s=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=s,c.request=i,o.parentNode.removeChild(o),r(c)}},o.href=t,document.head.appendChild(o)})(e,o,t,a)})),s={9782:0,3:0},l.f.miniCss=(e,t)=>{s[e]?t.push(s[e]):0!==s[e]&&{3:1,1391:1,1484:1,1877:1,1921:1,2101:1,2508:1,2651:1,2862:1,3776:1,4192:1,4194:1,4640:1,5138:1,5253:1,5322:1,5428:1,5662:1,5714:1,5965:1,6618:1,7040:1,7893:1,8296:1,8650:1,9164:1,9364:1,9387:1}[e]&&t.push(s[e]=n(e).then((()=>{s[e]=0}),(t=>{throw delete s[e],t})))},(()=>{var e={9782:0,3:0};l.f.j=(t,a)=>{var r=l.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else if(3!=t){var o=new Promise(((a,o)=>r=e[t]=[a,o]));a.push(r[2]=o);var n=l.p+l.u(t),s=new Error;l.l(n,(a=>{if(l.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=a&&("load"===a.type?"missing":a.type),n=a&&a.target&&a.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+n+")",s.name="ChunkLoadError",s.type=o,s.request=n,r[1](s)}}),"chunk-"+t,t)}else e[t]=0},l.O.j=t=>0===e[t];var t=(t,a)=>{var r,o,[n,s,i]=a,c=0;if(n.some((t=>0!==e[t]))){for(r in s)l.o(s,r)&&(l.m[r]=s[r]);if(i)var d=i(l)}for(t&&t(a);c<n.length;c++)o=n[c],l.o(e,o)&&e[o]&&e[o][0](),e[n[c]]=0;return l.O(d)},a=globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),l.O(void 0,[1216,504,7550,4998,1514,8075,2357,9356,2717,5298,741,1267,5379,876,995,9602,8680,323,4485,6962,9083,7843,6382,2825,3375,485,537,8868,9932,5618],(()=>l(26009)));var d=l.O(void 0,[1216,504,7550,4998,1514,8075,2357,9356,2717,5298,741,1267,5379,876,995,9602,8680,323,4485,6962,9083,7843,6382,2825,3375,485,537,8868,9932,5618],(()=>l(90001)));d=l.O(d)})();